<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yekta Amirkhalili">
<meta name="dcterms.date" content="2025-06-22">

<title>Effect Of Mental Health on Mobile Banking – Yekta’s Dissertation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-02e7b63b13b23c0d612b4df9d70fa878.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e1c82c21f31fdb0f854370cce998e929.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-02e7b63b13b23c0d612b4df9d70fa878.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Yekta’s Dissertation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./study1.html">Projects</a></li><li class="breadcrumb-item"><a href="./study2.html">Project 2. Mental Health</a></li><li class="breadcrumb-item"><a href="./study2_DA.html">Effect Of Mental Health on Mobile Banking</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
    <a href="./github.com/YektaDissertation" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./techAdopt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Technology Adoption</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mobileBanking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mobile Banking</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./study1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 1. SLR</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study1_tm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topic Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study1_theme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithmic Approach to Finding Themes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study1_DA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./study2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 2. Mental Health</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study2_DA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Effect Of Mental Health on Mobile Banking</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./study3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 3. Digital Divide</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study3_DA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Device Divide</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="./images/uw-logo.png" class="img-fluid"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link active" data-scroll-target="#data-analysis">Data Analysis</a>
  <ul class="collapse">
  <li><a href="#importing-libraries" id="toc-importing-libraries" class="nav-link" data-scroll-target="#importing-libraries">Importing Libraries</a></li>
  <li><a href="#introducing-the-cius-2020" id="toc-introducing-the-cius-2020" class="nav-link" data-scroll-target="#introducing-the-cius-2020">Introducing the CIUS 2020</a></li>
  <li><a href="#exploring-data" id="toc-exploring-data" class="nav-link" data-scroll-target="#exploring-data">EXPLORING DATA</a></li>
  <li><a href="#exploring-relations" id="toc-exploring-relations" class="nav-link" data-scroll-target="#exploring-relations">Exploring Relations</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#mathematical-modeling" id="toc-mathematical-modeling" class="nav-link" data-scroll-target="#mathematical-modeling">Mathematical Modeling</a></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models">Comparing models</a></li>
  <li><a href="#marginal-effects" id="toc-marginal-effects" class="nav-link" data-scroll-target="#marginal-effects">Marginal Effects</a></li>
  <li><a href="#fixed-effects-of-provinces-visualized" id="toc-fixed-effects-of-provinces-visualized" class="nav-link" data-scroll-target="#fixed-effects-of-provinces-visualized">Fixed Effects of Provinces Visualized</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./study1.html">Projects</a></li><li class="breadcrumb-item"><a href="./study2.html">Project 2. Mental Health</a></li><li class="breadcrumb-item"><a href="./study2_DA.html">Effect Of Mental Health on Mobile Banking</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Effect Of Mental Health on Mobile Banking</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yekta Amirkhalili </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 22, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- CSS CHANGES -->
<style>
.quarto-title h1.title {
  font-size: 1.5rem; 
}

h2{
    font-size: 1.2rem;
    background-color:rgba(128, 170, 156, 0.48);
}

.future-idea-box {
  border: 2px solid var(--quarto-hl-header-color, #86bdab); /* Uses Quarto header color variable or fallback */
  border-radius: 8px;
  padding: 1em;
  margin: 1em 0;
  background: #f9f9fc;
}
.future-idea-title {
  font-weight: bold;
  color: var(--quarto-hl-header-color,rgb(111, 172, 152));
  margin-bottom: 0.5em;
  font-size: 1.1em;
}

.variable-card {
  border: 2px solid #447099;           /* Choose your border color */
  background: #f5f8fa;                 /* Light background */
  border-radius: 8px;
  padding: 1.2em 1.5em;
  margin: 1em 0;
  box-shadow: 0 2px 8px rgba(68,112,153,0.05);
  max-width: 500px;
}

</style>
<!-- CSS CHANGES -->
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data Analysis</h2>
<p>In this project, I focused on analyzing how mental health relates to mobile banking adoption. I used data from the Canadian Internet Use Survey, which includes questions about digital habits, mental health, and demographics. You can find the dataset <a href="https://abacus.library.ubc.ca/dataset.xhtml;jsessionid=334500b45ffff5190ff22e232434?persistentId=hdl%3A11272.1%2FAB2%2FNUVBX2&amp;version=&amp;q=&amp;fileTypeGroupFacet=&amp;fileAccess=Public&amp;fileSortField=name&amp;fileSortOrder=desc">here</a>. I built a fixed-effects logistic regression model, grouped by <code>province</code>, to control for regional differences as this was the sampling cluster. My main variable was self-reported mental health scores. I included factors like relationship satisfaction, smartphone dependency, and social media use. I also tested interaction effects to see if these variables change the way mental health influences mobile banking use. The following is a step-by-step on the coding and analysis of the project.</p>
<section id="importing-libraries" class="level3">
<h3 class="anchored" data-anchor-id="importing-libraries">Importing Libraries</h3>
<p>Note that not all libraries may be utilized. The most important ones are <code>dplyr</code>, <code>lme4</code>, <code>tidyr</code>, <code>ggplot2</code>, <code>psych</code>, <code>corrr</code>, <code>haven</code>, <code>marginaleffects</code> and <code>margins</code> and any related libraries to these.</p>
</section>
<section id="introducing-the-cius-2020" class="level3">
<h3 class="anchored" data-anchor-id="introducing-the-cius-2020">Introducing the CIUS 2020</h3>
<p>I first started by reading the entire PUMF file available.<br>
This gives you information on how the survey was set up, why, and how things were measured. Then, I looked at the individual survey questions to see the available data, and how they were measured. In general, questions are measured numerically were answeres follow as such: &gt; Yes : 1, No : 2, Valid Skip: 6, Don’t Know: 7, Refusal: 8, Not Stated: 9 Of course this differs question-by-question as some questions have other answer categories and some questions (which were note used in my study) asked for numerical input from the participants (like how much did you spend online last year). To help readers understand the data, I will include the question exactly as it appears in the CIUS 2020 PUMF Data Dictionary with corresponding answer choices and codes. These will be in a blue-bordered box, and will include the Variable name (on the PUMF file), Concept, Question Body and Answers. Then I will show you in R code how I’ve re-coded and used the question as a model variable. The Variables I need are as follows:</p>
<ul>
<li>Mobile banking adoption (<code>mBanking</code>)</li>
<li>Age Group (<code>AGE</code>)</li>
<li>Smartphone Dependent (<code>SD</code>)</li>
<li>Income Quintile (<code>INC</code>)</li>
<li>Friendship Satisfaction (<code>FRISAT</code>)</li>
<li>Mental Health (MH)</li>
<li>Family Relation Satisfaction (<code>FAMSAT</code>)</li>
<li>Education Level (<code>EDU</code>)</li>
<li>Immigration Status (<code>IMM</code>)</li>
<li>Employment Status (<code>EMP</code>)</li>
<li>Family Type (<code>FAM</code>)</li>
<li>Gender (<code>SEX</code>)</li>
<li>Social Media Use (<code>SNS</code>)</li>
<li>Province (<code>province</code>)</li>
</ul>
<p>The data is available in various formats. To avoid data loss, I decided to use the <code>.dta</code> format (SAS file). You need the <code>haven</code> package to read SAS files. However, this file is 150MB in size and since I am uploading the code in my GitHub repository, I am not able to use the SAS file. So I’ve saved the data in a <code>.csv</code> file with only the columns I will need. This is how you’d read a SAS file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ds20 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data/cius2020_2022nov18_en.dta"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds20</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Instead, I run this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ds10 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"ds.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds10 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 1. Smartphone Users</strong> Select only those who use smartphones because the question is about “online banking” and not “mobile banking”.</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> DV_010A</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Devices used</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
During the past three months, what devices did you use to access the Internet?<br>
Did you use:<br>
<em>A smartphone</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Yes</td>
<td>1</td>
</tr>
<tr class="even">
<td>No</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Valid Skip</td>
<td>6</td>
</tr>
<tr class="even">
<td>Don’t Know</td>
<td>7</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="even">
<td>Not Stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">devSM =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            dv_010a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#yes</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            dv_010a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#no</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="co">#any valid skip and not stated </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(devSM <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 2. Mobile Banking Question</strong> Select the outcome variable, mobile banking:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> UI_050D</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Activities related to other online activities</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
During the past three months, which of the following other online activities, have you done over the Internet? Have you: <em>Conducted online banking</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Yes</td>
<td>1</td>
</tr>
<tr class="even">
<td>No</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Valid Skip</td>
<td>6</td>
</tr>
<tr class="even">
<td>Don’t Know</td>
<td>7</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="even">
<td>Not Stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Step 3. Select Other Model Variables</strong> Now I will move on to selecting the predictors. For Smartphone Dependency:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> SM_030A</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Frequency of use of smartphone</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
In a typical day, how often do you check your smartphone?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>At least every 5 minutes</td>
<td>01</td>
</tr>
<tr class="even">
<td>At least every 15 minutes</td>
<td>02</td>
</tr>
<tr class="odd">
<td>At least every 30 minutes</td>
<td>03</td>
</tr>
<tr class="even">
<td>One time per hour</td>
<td>04</td>
</tr>
<tr class="odd">
<td>Once a day or a few times per day</td>
<td>05</td>
</tr>
<tr class="even">
<td>Less than one time per day</td>
<td>06</td>
</tr>
<tr class="odd">
<td>Valid skip</td>
<td>96</td>
</tr>
<tr class="even">
<td>Don’t know</td>
<td>97</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>98</td>
</tr>
<tr class="even">
<td>Not stated</td>
<td>99</td>
</tr>
</tbody>
</table>
</div>
<p>As you can see, this one is no longer just a yes/no question, but has a few categories for answers. Since I’m thinking of tracking “dependence”, it makes sense that the more frequent checking gets a higher value. So, this is how I code this variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">#timeline : past 3 months </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">mBanking =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            ui_050d <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Yes </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            ui_050d <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># No </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.default =</span> <span class="sc">-</span><span class="dv">1</span> <span class="co"># valid skip, don't know, refused, not stated </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">SD =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">6</span>, <span class="co"># At least every 5 minutes </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co"># At least every 15 minutes </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="co"># At least every 30 minutes  </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">3</span>, <span class="co"># One time per hour  </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="co"># Once a day or a few times per day  </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Less than one time per day</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.default =</span> <span class="dv">96</span> <span class="co"># Valid skip 96 , Don’t know 97 , Refusal  98, Not stated  99</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SD <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The filters are just making sure that the skip’s, don’t know’s, refusal’s and not stated answers are dropped. This is not too big of a loss. There are <span class="math inline">17,409</span> rows of data.</p>
<p>Friendship Satisfaction:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> TS_010A</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Satisfaction with relationships</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
In general, on a scale from 1 to 5 where 1 means «completely dissatisfied» and 5 means «completely satisfied», how satisfied are you with the relationships you have with the following people? <em>Friends</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1-Completely dissatisfied</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5- Completely satisfied</td>
<td>5</td>
</tr>
<tr class="even">
<td>Valid skip</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Don’t know</td>
<td>7</td>
</tr>
<tr class="even">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="odd">
<td>Not stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<p>Family Satisfaction:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> TS_010B</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Satisfaction with relationships</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
In general, on a scale from 1 to 5 where 1 means «completely dissatisfied» and 5 means «completely satisfied», how satisfied are you with the relationships you have with the following people? <em>Relatives or family members, excluding those you live with</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1-Completely dissatisfied</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5- Completely satisfied</td>
<td>5</td>
</tr>
<tr class="even">
<td>Valid skip</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Don’t know</td>
<td>7</td>
</tr>
<tr class="even">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="odd">
<td>Not stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<p>Mental Health:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> FD_030A</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Perceived mental health</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
In general, how is your mental health? Would you say:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Excellent</td>
<td>1</td>
</tr>
<tr class="even">
<td>Very good</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Good</td>
<td>3</td>
</tr>
<tr class="even">
<td>Fair</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Poor</td>
<td>5</td>
</tr>
<tr class="even">
<td>Valid skip</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Don’t know</td>
<td>7</td>
</tr>
<tr class="even">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="odd">
<td>Not stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<p>Again, since I want to measure mental health in terms of how good or bad a person is, it makes sense that better moods are associated with elevated numbers (so instead of it being coded as 1, Excellent should be coded as 5).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">FRISAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#completely dissatisfied </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#completely satisfied </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAMSAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#completely dissatisfied </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#completely satisfied </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">MH =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#excellent </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="co">#very good </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>, <span class="co">#good </span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="co">#fair</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#poor</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    FRISAT <span class="sc">&lt;</span> <span class="dv">6</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    FAMSAT <span class="sc">&lt;</span> <span class="dv">6</span>,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    MH <span class="sc">&lt;</span> <span class="dv">6</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Social Media use:</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> UI_010C</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Activities related to communication</p>
</div>
</div>
<p><strong>Question Text:</strong><br>
During the past three months, which of the following activities, related to communication, have you done over the Internet? Have you: <em>Used social networking websites or apps</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Yes</td>
<td>1</td>
</tr>
<tr class="even">
<td>No</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Valid skip</td>
<td>6</td>
</tr>
<tr class="even">
<td>Don’t know</td>
<td>7</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
</tr>
<tr class="even">
<td>Not stated</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">SNS =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        ui_010c <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># yes </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        ui_010c <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># no </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">3</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    SNS <span class="sc">&lt;</span> <span class="dv">3</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 4. Gather Demographic and Other Information</strong> Here, I will select some demographic information. Since these are not direct questions but information retrieved from other sources (such as postal codes for province), some of them do not have Skips/Don’t Know/Refusal/Not Stated answers. If they have, I have added those to the cards. I have also added a frequency column for these variables only to show you the demographic distribution of the sample (not weighted).</p>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> PROVINCE</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> PROVINCE</p>
</div>
</div>
<p><strong>Note:</strong><br>
Information derived using postal codes.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Newfoundland and Labrador</td>
<td>10</td>
<td>950</td>
</tr>
<tr class="even">
<td>Prince Edward Island</td>
<td>11</td>
<td>1,154</td>
</tr>
<tr class="odd">
<td>Nova Scotia</td>
<td>12</td>
<td>1,181</td>
</tr>
<tr class="even">
<td>New Brunswick</td>
<td>13</td>
<td>1,223</td>
</tr>
<tr class="odd">
<td>Quebec</td>
<td>24</td>
<td>3,911</td>
</tr>
<tr class="even">
<td>Ontario</td>
<td>35</td>
<td>3,719</td>
</tr>
<tr class="odd">
<td>Manitoba</td>
<td>46</td>
<td>973</td>
</tr>
<tr class="even">
<td>Saskatchewan</td>
<td>47</td>
<td>979</td>
</tr>
<tr class="odd">
<td>Alberta</td>
<td>48</td>
<td>1,365</td>
</tr>
<tr class="even">
<td>British Columbia</td>
<td>59</td>
<td>1,954</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> AGE_GRP</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Age Groups – Derived variable</p>
</div>
</div>
<p><strong>Note:</strong><br>
Derived from age of persons in the household</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>15 to 24 years</td>
<td>01</td>
<td>828</td>
</tr>
<tr class="even">
<td>25 to 34 years</td>
<td>02</td>
<td>1,805</td>
</tr>
<tr class="odd">
<td>35 to 44 years</td>
<td>03</td>
<td>2,520</td>
</tr>
<tr class="even">
<td>45 to 54 years</td>
<td>04</td>
<td>2,469</td>
</tr>
<tr class="odd">
<td>55 to 64 years</td>
<td>05</td>
<td>3,889</td>
</tr>
<tr class="even">
<td>65 years and over</td>
<td>06</td>
<td>5,898</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> GENDER</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Gender - Derived variable</p>
</div>
</div>
<p><strong>Note:</strong><br>
Refers to current gender which may be different from sex assigned at birth and may be different from what is indicated on legal documents. For data quality and confidentiality reasons, and because of the small population being measured, the dissemination of data according to ’Non binary’ Gender is not possible for this statistical program. So, this release uses a gender variable with only two categories. This variable is derived by looking at a large number of demographic characteristics from the respondent, it allows us to disseminate data on Gender that is reliable and unbiased.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Male</td>
<td>1</td>
<td>8,126</td>
</tr>
<tr class="even">
<td>Female</td>
<td>2</td>
<td>9,283</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> EMP</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Employment status - Derived variable</p>
</div>
</div>
<p><strong>Note:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Employed</td>
<td>1</td>
<td>8,451</td>
</tr>
<tr class="even">
<td>Not Employed</td>
<td>2</td>
<td>8,177</td>
</tr>
<tr class="odd">
<td>Valid Skip</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td>Don’t Know</td>
<td>7</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
<td>0</td>
</tr>
<tr class="even">
<td>Not Stated</td>
<td>9</td>
<td>781</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> G_EDU</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Highest certificate - Derived variable</p>
</div>
</div>
<p><strong>Note:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>High school or less</td>
<td>1</td>
<td>5,746</td>
</tr>
<tr class="even">
<td>Some post-secondary (incl.&nbsp;univ certificate)</td>
<td>2</td>
<td>5,866</td>
</tr>
<tr class="odd">
<td>University degree</td>
<td>3</td>
<td>4,889</td>
</tr>
<tr class="even">
<td>Valid skip</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Don’t know</td>
<td>7</td>
<td>0</td>
</tr>
<tr class="even">
<td>Refusal</td>
<td>8</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Not stated</td>
<td>9</td>
<td>908</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> G_HCOMP</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Type of household - Derived variable</p>
</div>
</div>
<p><strong>Note:</strong><br>
This derived variable indicates the household composition. It was derived using RRS_Q12 (number of persons in the household), RR_020CA (age of persons in the household) and RR_040AA (relationship of the respondent with the other members of the household).</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Family household with children under 18</td>
<td>1</td>
<td>3,700</td>
</tr>
<tr class="even">
<td>Family household without children under 18</td>
<td>2</td>
<td>8,299</td>
</tr>
<tr class="odd">
<td>Single person household</td>
<td>3</td>
<td>4,837</td>
</tr>
<tr class="even">
<td>Other household type</td>
<td>4</td>
<td>414</td>
</tr>
<tr class="odd">
<td>Valid skip</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td>Don’t know</td>
<td>7</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
<td>0</td>
</tr>
<tr class="even">
<td>Not stated</td>
<td>9</td>
<td>159</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> HINCQUIN</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Census family income quintile - Derived variable</p>
</div>
</div>
<p><strong>Note:</strong><br>
Information derived using HINC. In order to obtain equal weighted counts in each category, cases with incomes equal to the category cutoffs were randomly assigned to one of the two categories on either side of the cutoff.</p>
<p><strong>Source:</strong> Annual Income Estimates for Census Families and Individuals (T1 Family File)</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Quintile 1 - <span class="math inline">\leq</span> $44,119</td>
<td>1</td>
<td>4,200</td>
</tr>
<tr class="even">
<td>Quintile 2 - $44,120 - $75,321</td>
<td>2</td>
<td>3,911</td>
</tr>
<tr class="odd">
<td>Quintile 3 - $75,322 - $109,431</td>
<td>3</td>
<td>3,394</td>
</tr>
<tr class="even">
<td>Quintile 4 - $109,432 - $162,799</td>
<td>4</td>
<td>3,185</td>
</tr>
<tr class="odd">
<td>Quintile 5 - <span class="math inline">\geq</span> $162,800</td>
<td>5</td>
<td>2,719</td>
</tr>
</tbody>
</table>
</div>
<div class="variable-card">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Variable Name:</strong> IMM_GSTA</p>
</div><div class="column" style="width:50%;">
<p><strong>Concept:</strong> Immigrant status</p>
</div>
</div>
<p><strong>Note:</strong><br>
Landed immigrants are permanent residents who have indicated a year of landing in Canada since 1980. Variable derived from LANDING_YEAR, IMDB.</p>
<p><strong>Source:</strong> Longitudinal Immigration Database (IMDB)</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Answer Categories</strong></th>
<th><strong>Code</strong></th>
<th><strong>Frequency</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Landed immigrant</td>
<td>1</td>
<td>1,696</td>
</tr>
<tr class="even">
<td>Non-landed immigrant</td>
<td>2</td>
<td>15,701</td>
</tr>
<tr class="odd">
<td>Valid Skip</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td>Don’t Know</td>
<td>7</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Refusal</td>
<td>8</td>
<td>0</td>
</tr>
<tr class="even">
<td>Not Stated</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
<p>Variable <code>pumfid</code> is just a unique identifier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> pumfid,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">province =</span> province, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE =</span> <span class="fu">as.integer</span>(age_grp),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SEX =</span> gender,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMP =</span> <span class="fu">ifelse</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        emp <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        emp</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDU =</span> g_edu,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAM =</span> g_hcomp, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">IMM =</span> <span class="fu">ifelse</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        imm_gsta <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        imm_gsta</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">INC =</span> hincquin</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    SNS <span class="sc">&lt;</span> <span class="dv">3</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    EMP <span class="sc">&lt;</span> <span class="dv">3</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    FAM <span class="sc">&lt;</span> <span class="dv">5</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    IMM <span class="sc">&lt;</span> <span class="dv">3</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 5. Selecting The Variables From Data Set</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                  mBanking, SD, FAMSAT, FRISAT, MH, SNS,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                  province, AGE, SEX, EMP, EDU,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  FAM, IMM, INC, wtpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Size of the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploring-data" class="level3">
<h3 class="anchored" data-anchor-id="exploring-data">EXPLORING DATA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(ds, <span class="at">type =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(n, mean, sd, median, min, max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Seems like it’s kind of rare for those that use m-banking to have lower MH scores. Descriptive statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data    =</span> ds,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x   =</span> SD,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y   =</span> wtpg,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">as.factor</span>(MH)))<span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Smartphone Dependency"</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Weight"</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"MH"</span>) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checking Na’s:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(ds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploring-relations" class="level3">
<h3 class="anchored" data-anchor-id="exploring-relations">Exploring Relations</h3>
<p>Visualizng the relationship between Mental Health and M-banking:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ds, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(mBanking)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Frequencies"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Mbanking"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>MH and controls: AGE, SEX, EMP, EDU, FAM, IMM, INC</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gg_fam <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FAM))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FAMILY'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>gg_age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(AGE))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'AGE'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>gg_edu <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(EDU))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'EDU'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>gg_inc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(INC))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'INC'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>gg_sex <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SEX))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SEX'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>gg_emp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(EMP))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'EMP'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>gg_imm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(IMM))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'Immigrant'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    gg_fam, gg_age, gg_edu, gg_inc, gg_sex, gg_emp, gg_imm,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FAM"</span>, <span class="st">"AGE"</span>, <span class="st">"EDU"</span>, <span class="st">"INC"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"IMM"</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>MH and other variables: SD, FAMSAT, FRISAT, SNS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gg_frisat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FRISAT))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FRISAT'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>gg_famsat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FAMSAT'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>gg_sd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SD))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SD'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>gg_sns <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SNS))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SNS'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    gg_frisat, gg_famsat, gg_sd, gg_sns,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FRISAT"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"SD"</span>, <span class="st">"SNS"</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="correlation-matrix" class="level4">
<h4 class="anchored" data-anchor-id="correlation-matrix">Correlation Matrix</h4>
<p>All variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sle <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(mBanking, SD, FAMSAT, FRISAT, SNS, AGE, SEX, EMP, EDU, FAM, INC, MH)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>corM <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(sle))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>reg_corM <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(corM<span class="sc">$</span>r)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(reg_corM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mBanking"</span>, <span class="st">"SD"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"FRISAT"</span>, <span class="st">"SNS"</span>, <span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"EDU"</span>, <span class="st">"FAM"</span>, <span class="st">"INC"</span>, <span class="st">"MH"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(reg_corM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mBanking"</span>, <span class="st">"SD"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"FRISAT"</span>, <span class="st">"SNS"</span>, <span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"EDU"</span>, <span class="st">"FAM"</span>, <span class="st">"INC"</span>, <span class="st">"MH"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(reg_corM, <span class="at">p.mat =</span> corM<span class="sc">$</span>P, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">insig =</span> <span class="st">'label_sig'</span>, <span class="at">sig.level =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>), <span class="at">pch.cex =</span> <span class="fl">0.9</span>, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> <span class="dv">1</span>, <span class="at">diag =</span> F, <span class="at">col =</span> corrplot<span class="sc">::</span><span class="fu">COL2</span>(<span class="st">'PuOr'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>FRISAT</code> and <code>FAMSAT</code> are obviously highly correlated. I’ll combine them into a new variable called <code>RS</code> for Relationship satisfaction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">RS =</span> FAMSAT <span class="sc">+</span> FRISAT</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="showing-that-its-ok-to-replace-famsat-frisat-rs" class="level5">
<h5 class="anchored" data-anchor-id="showing-that-its-ok-to-replace-famsat-frisat-rs">Showing that it’s ok to replace FAMSAT + FRISAT = RS</h5>
<p>Using a Likelihood Ratio Test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_famsatfrisat <span class="ot">&lt;-</span> <span class="fu">glm</span>(mBanking <span class="sc">~</span> FAMSAT <span class="sc">+</span> FRISAT, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ds)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>model_rs <span class="ot">&lt;-</span> <span class="fu">glm</span>(mBanking <span class="sc">~</span> RS, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ds)   </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_rs, model_famsatfrisat, <span class="at">test =</span> <span class="st">"Chisq"</span>)               </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since <span class="math inline">p &gt; 0.05</span>, there is no significant difference in model performance. It’s better to keep one variable instead of two (simpler model is better).</p>
<p>Continuing with our visualizations, let’s see the changes to SD across MH scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> ds, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> SD))<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">se     =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col    =</span> <span class="st">"red"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">size   =</span> <span class="dv">2</span>, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha  =</span> .<span class="dv">8</span>)<span class="sc">+</span> <span class="co"># to add regression line</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There’s an almost negative linear relationship there: better mental health is associated with lower dependency on smartphones. This intuitively makes sense. Adding more nuance to this graph, I can see how this relationship changes for people who adopted m-banking and those that didn’t. It seems the two relationships are almost identical, at least in direction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data    =</span> ds,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x   =</span> MH,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y   =</span> SD,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">as.factor</span>(mBanking)))<span class="sc">+</span> <span class="co">#to add the colours for different classes</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size     =</span> <span class="fl">1.2</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha    =</span> .<span class="dv">8</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_color_manual(name = "MBanking",</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#labels = c("No", "Yes"),</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#values = c("red", "lightblue")) + #+ ggnewscale::new_scale_color() +</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method   =</span> lm,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">se       =</span> T, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">size     =</span> <span class="fl">1.5</span>, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha    =</span> .<span class="dv">7</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span> </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"MBanking"</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"darkred"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The same type of visualizations can be helpful for other factors in the model. Now, I will separate the data into those that have adopted m-banking and those that haven’t. Let’s look at the differences in familial relationship satisfaction for these two groups across mental health. For m-banking adopters, it seems that those with better mental health (3 or higher) are completely satisfied with their family relationships (blue bar). On the other hand, those that haven’t adopted m-banking are either less satisfied or completely unsatisfied (<code>MH = 5, mBanking = 0</code> group’s largest bar is red, which is <code>FAMSAT = 1</code>, the lowest score).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ds1 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ds2 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>gg5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"FAMSAT"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>gg6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"FAMSAT"</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg5, gg6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s important to mention that visualizations don’t actually tell us the real story. Especially when working with large datasets with more than 10,000 data points. This is simply a somewhat visible pattern that tells me it’s worth looking into when I do my statistical analysis. We do the same type of visualization, now measuring social media use. Surprisingly, social media use goes up with better mental health scores for adopters but decreases for non-adopters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gg7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SNS)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SNS"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>gg8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SNS)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SNS"</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg7, gg8, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we do the same with smartphone dependency. It seems that non-adopters are actually more dependent on their smartphones and also (with better mental health).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gg9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SD)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SD"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>gg10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SD)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SD"</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg9, gg10, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>I prepare the data for modeling by:</p>
<ol type="1">
<li>Calculating mean-centered values for the numeric columns for easier interpretation since no value has a true zero.</li>
<li>I convert some variables to factors, which are categorical variables with different levels and define various reference points for each for easier modeling practices</li>
<li>Note that if a variable’s reference level is <code>l</code>, then all the logistic regression coefficients for other levels are in comparison to level <code>l</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">MH_c =</span> MH <span class="sc">-</span> <span class="fu">mean</span>(MH), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_c =</span> SD <span class="sc">-</span> <span class="fu">mean</span>(SD),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">SNS_f =</span> <span class="fu">as.factor</span>(SNS),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RS_c =</span> RS <span class="sc">-</span> <span class="fu">mean</span>(RS),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_c =</span> AGE <span class="sc">-</span> <span class="fu">mean</span>(AGE),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SEX_f =</span> <span class="fu">as.factor</span>(SEX),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMP_f =</span> <span class="fu">as.factor</span>(EMP),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDU_c =</span> EDU <span class="sc">-</span> <span class="fu">mean</span>(EDU),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAM_f =</span> <span class="fu">as.factor</span>(FAM),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">INC_c =</span> INC <span class="sc">-</span> <span class="fu">mean</span>(INC),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">IMM_f =</span> <span class="fu">as.factor</span>(IMM),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">PRVNC =</span> <span class="fu">as.factor</span>(province)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SEX </span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">SEX_factor_Fem =</span> <span class="fu">relevel</span>(SEX_f, <span class="at">ref =</span> <span class="st">'2'</span>),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">SEX_factor_Mal =</span> <span class="fu">relevel</span>(SEX_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># EMP</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">EMP_factor_not =</span> <span class="fu">relevel</span>(EMP_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">EMP_factor_Emp =</span> <span class="fu">relevel</span>(EMP_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># FAM </span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_1 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_2 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'2'</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_3 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'3'</span>),</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_4 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'4'</span>),</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># IMM</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">IMM_factor_Imm =</span> <span class="fu">relevel</span>(IMM_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">IMM_factor_non =</span> <span class="fu">relevel</span>(IMM_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SNS </span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">SNS_factor_notuse =</span> <span class="fu">relevel</span>(SNS_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">SNS_factor_use =</span> <span class="fu">relevel</span>(SNS_f, <span class="at">ref =</span> <span class="st">'1'</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="considering-sampling-clusters" class="level4">
<h4 class="anchored" data-anchor-id="considering-sampling-clusters">Considering Sampling Clusters</h4>
<p>This dataset was sampled by clustering on provinces. CIUS does not disclose their sample measure in full detail, but it is best practice to consider this sampling design in the model. There are multiple ways to do it:</p>
<ul>
<li>Apply the weights to the model in <code>glm()</code>; since the dataset is quite large, adding the weights will render everything statistically significant and therefore is not useful for our purposes</li>
<li>Use a survey-specific module like the <code>survey</code> package developed by <a href="https://www.rdocumentation.org/packages/survey/versions/4.4-2">Thomas Lumley</a> to account for survey methods, stratification, framing, sampling strategy and weights. The way you’d do this is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define survey design </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ds_svy <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>province, <span class="at">weights =</span> <span class="sc">~</span>wtpg, <span class="at">data =</span> ds)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># run survey glm : svyglm()</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>model1_svy <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> ..., </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">family=</span>stats<span class="sc">::</span><span class="fu">gaussian</span>(),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">start=</span><span class="cn">NULL</span>, <span class="at">rescale=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">FALSE</span>,<span class="at">influence=</span><span class="cn">FALSE</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1_svy, <span class="at">correlation =</span> <span class="cn">FALSE</span>, <span class="at">df.resid=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Another method is to consider robust standard errors</li>
<li>Lastly, the method I’ve decided on is to consider this clustering in the model as a group using mixed-effect models</li>
</ul>
<p>Let’s visualize the distribution of m-banking adoption across provinces for all <code>MH</code> scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">province_f_coded =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            PRVNC,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NL'</span> <span class="ot">=</span> <span class="st">'10'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NS'</span> <span class="ot">=</span> <span class="st">'12'</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NB'</span> <span class="ot">=</span> <span class="st">'13'</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">'QC'</span> <span class="ot">=</span> <span class="st">'24'</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ON'</span> <span class="ot">=</span> <span class="st">'35'</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MB'</span> <span class="ot">=</span> <span class="st">'46'</span>, </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SK'</span> <span class="ot">=</span> <span class="st">'47'</span>, </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">'AB'</span> <span class="ot">=</span> <span class="st">'48'</span>, </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BC'</span> <span class="ot">=</span> <span class="st">'59'</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds, <span class="fu">aes</span>(province_f_coded, mBanking, <span class="at">color =</span> <span class="fu">as.factor</span>(MH))) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Province"</span>, <span class="at">y =</span> <span class="st">"Observed Probabilty of mobile banking"</span>, <span class="at">color =</span> <span class="st">"MH"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is clearly some variation in the probabilities of m-banking and the effects of <code>MH</code> on this across the provinces.</p>
</section>
<section id="mathematical-modeling" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-modeling">Mathematical Modeling</h3>
<p>Following the paper, I have these models (I’m skipping over the choise of <code>RS</code> instead of <code>FAMSAT + FRISAT</code> as it was discussed above):</p>
<p><strong>Model 1. Standard Logistic Regression</strong></p>
<p><span class="math display">
\begin{equation*}
\begin{split}
  &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = \\
  &amp; \ \beta_0 + \beta_{1} \ MH + \ \beta_2 \ SD + \ \beta_3 \ D_{SNS_0} + \ \beta_4 \ AGE \ + \ \beta_5 \ D_{SEX_m} \\
  &amp;  + \ \beta_6 \ D_{EMP_0} \ + \ \beta_7 \ EDU + \ \beta_8 \ INC \ + \ \beta_9 \ D_{FAM_1} + \ \beta_{10} \ D_{FAM_3}\\
  &amp; + \ \beta_{11} \ D_{FAM_4} \ + \ \beta_{12} \ D_{IMM_1} + \ \beta_{13} \ RS + \ \epsilon \\
\end{split}
\end{equation*}
</span></p>
<p>Where <span class="math inline">D</span> is a dummy variable representing the case that the value of the variable in the index is some specific level. For example, <span class="math inline">D_{SNS_0}</span> gets a <span class="math inline">1</span> in every cell where <code>SNS = 0</code>. This is modeled in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Model 2. Fixed Effect Logistic Regression</strong></p>
<p><span class="math display">
\begin{equation*}
\begin{split}
  &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = \\
  &amp; \ \gamma_{0,j} + u_{0,j} + \beta_{1} \ MH + \ \beta_2 \ SD + \ \beta_3 \ D_{SNS_0} + \ \beta_4 \ AGE \ + \ \beta_5 \ D_{SEX_m}\\
  &amp;  + \ \beta_6 \ D_{EMP_0} \ + \ \beta_7 \ EDU + \ \beta_8 \ INC \ + \ \beta_9 \ D_{FAM_1} + \ \beta_{10} \ D_{FAM_3}\\
  &amp; + \ \beta_{11} \ D_{FAM_4} \ + \ \beta_{12} \ D_{IMM_1} + \ \beta_{13} \ RS + \ \epsilon \\
\end{split}
\end{equation*}
</span></p>
<p>This is where <code>province</code> only affects the intercept (m-banking). I used the <code>glmer</code> function from the <code>lme4</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> province),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Model 3. Random Effect Logistic Regression</strong></p>
<p><span class="math display">
\begin{equation*}
\begin{split}
   &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = \\
   &amp; \ \gamma_{0,0} + u_{0,j} + (\gamma_{1,0} + u_{1,j}) \ MH + \ (\gamma_{2,0} + u_{2,j}) \ SD \ + \ (\gamma_{3,0} + u_{3,j}) \ SNS \\
   &amp; + \ (\gamma_{4,0} + u_{4,j}) \ AGE \ + \ (\gamma_{5,0} + u_{5,j}) \ SEX \ + \ (\gamma_{6,0} + u_{6,j}) EMP \\
   &amp; + \ (\gamma_{7,0} + u_{7,j}) \ EDU \ + \ (\gamma_{8,0} + u_{8,j}) \ INC \
    + \ (\gamma_{9,0} + u_{9,j}) \ D_{FAM_1} \\
   &amp; + \ (\gamma_{10,0} + u_{10,j}) \ D_{FAM_3} \ + \ (\gamma_{11,0} + u_{11,j}) \ D_{FAM_4} \\
   &amp; + \ (\gamma_{12,0} + u_{12,j}) \ IMM_1 \ + \ (\gamma_{13,0} + u_{13,j}) \ RS + \ \epsilon \\
\end{split}
\end{equation*}
</span></p>
<p>This is where <code>province</code> only affects everything. This model may not converge (it does in this case, but it takes about 30 minutes with no other processes running on a Macbook Air M2). An easier model that considers random effects may be to just include the random effect on the primary variable <code>MH</code> and its related constructs (<code>model4</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_f <span class="sc">+</span> EMP <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_2 <span class="sc">+</span> IMM_n <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    INC_c <span class="sc">|</span> province),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For faster speeds, I’ll test everything with this model (random):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">|</span> province),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparing-models" class="level3">
<h3 class="anchored" data-anchor-id="comparing-models">Comparing models</h3>
<p>Since <code>model3</code> doesn’t run fast and I am using <code>Quarto</code> for rendering the code blocks, I decided to use <code>model4</code> for comparisons. The values here will be different from the paper, but the ideas are the same. To pick the best model I do:</p>
<ul>
<li>Likelihood Ratio Test to pick between <code>model1</code> vs <code>model2</code> - the null hypothesis is that there is no significant difference between the models (if you reject this, then you should go with the model that captures more information)
<ul>
<li>If you reject <span class="math inline">H_0</span> of LR test, i.e., <code>model2</code> wins <span class="math inline">\implies</span> we compare it to <code>model4</code> and we need the Hausman test
<ul>
<li>Unfortunately, the Hausman test requires the <code>plm</code> package and panel data. To avoid messing the data up again, I coded the calculations manually based on the Hausman formula. This is referenced in the paper.</li>
</ul></li>
<li>If you can’t reject <span class="math inline">H_0</span> of LR test, i.e., <code>model1</code> wins, we should just use that as it’s simpler</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(model1, model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since <code>model2</code> won, we now compare it with <code>model4</code>. Hausman test for fixed effects in R is a bit tricky, so, I did it manually following the formula:</p>
<ol type="1">
<li>Extract per-group (province) coefficients for both models and convert them to data frames</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>coefs_fixed <span class="ot">&lt;-</span> <span class="fu">coef</span>(model2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>coefs_rando <span class="ot">&lt;-</span> <span class="fu">coef</span>(model4)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>coefs_fixed_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coefs_fixed<span class="sc">$</span>province)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>coefs_rando_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coefs_rando<span class="sc">$</span>province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Subtract Random Effects model coefficients from Fixed Effect model, per province. This gives you the core term of the Hausman test:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>coefs_diff <span class="ot">&lt;-</span> coefs_fixed_df <span class="sc">-</span> coefs_rando_df</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>coef_diffs_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coefs_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Estimate the difference in the variance-covariance matrices of the coefficient estimates.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>V_diff <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vcov</span>(model2) <span class="sc">-</span> <span class="fu">vcov</span>(model4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What I need is:</p>
<p><span class="math display">
H = (\hat{\beta_{F}} - \hat{\beta_{R}}) \cdot V^{-1} \cdot (\hat{\beta_{F}} - \hat{\beta_{R}})^T
</span></p>
<p>Just checking that the matrix multiplications make sense:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">t</span>(coef_diffs_matrix))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">solve</span>(V_diff))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(coef_diffs_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>They do! So, calculate <span class="math inline">H</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> coef_diffs_matrix <span class="sc">%*%</span> <span class="fu">solve</span>(V_diff) <span class="sc">%*%</span> <span class="fu">t</span>(coef_diffs_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the actual critical <span class="math inline">\chi^2</span> value at degrees of freedom 13 (for 14 covariates), in fact, I can check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(V_diff)<span class="sc">$</span>rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>chisq_critical <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> <span class="dv">13</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>chisq_critical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If <span class="math inline">H1 &gt; \chi^2</span> then reject the null hypothesis that says the fixed model is better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>H <span class="sc">&gt;</span> chisq_critical <span class="co">#reject H0: the fixed model is better.  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(H, <span class="at">df =</span> <span class="dv">13</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ok, we can’t reject this hypothesis - therefore, the fixed model is better. Another way to check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2, model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The models are basically the same - which means, go with the simpler one! So, best model is <code>model2</code>. Now adding interaction terms to test the hypotheses of study 2, which are:</p>
<ul>
<li>Mental Health significantly affects mobile banking adoption.</li>
<li>Relationship Satisfaction moderates the effect of Mental Health on adoption.</li>
<li>Smartphone Dependency moderates the effect of Mental Health on adoption.</li>
<li>Social Media use moderates the effect of Mental Health on adoption.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>model2_int <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> MH_c<span class="sc">:</span>RS_c <span class="sc">+</span> MH_c<span class="sc">:</span>SD_c <span class="sc">+</span> MH_c<span class="sc">:</span>SNS_factor_use </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> province),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Printing both odds ratios and log-odds versions using two different summary functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    model2,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> F,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvals =</span> T,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp =</span> T, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#part.corr = T, #Print partial (labeled "partial.r") and semipartial (labeled "part.r")</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#confint = getOption("summ-confint", FALSE),</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ci.width = getOption("summ-ci.width", 0.95),</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#vifs = T</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    model2_int,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> F,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvals =</span> T,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp =</span> T, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#part.corr = T, #Print partial (labeled "partial.r") and semipartial (labeled "part.r")</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#confint = getOption("summ-confint", FALSE),</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ci.width = getOption("summ-ci.width", 0.95),</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#vifs = T</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also calculating the confidence interval for the variances of each model (we should really only care about the intercept variance, maybe MH):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">confint</span>(model2),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="./images/CIs.png" class="img-fluid"></p>
<p>And the random effects for provinces (for visualization later):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="marginal-effects" class="level3">
<h3 class="anchored" data-anchor-id="marginal-effects">Marginal Effects</h3>
<p>First, let’s see which model is better:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2, model2_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(model2, model2_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since <code>model2</code> is simpler, and they’re not different, I’ll go with that. Average marginal effects are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">margins_summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fixed-effects-of-provinces-visualized" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effects-of-provinces-visualized">Fixed Effects of Provinces Visualized</h3>
<p>To finish this discussion, I’ll visualize the fixed effects of provinces. The y-axis shows the intercept shift (effect) for each province. A higher value on the y-axis (positive effect) means that after controlling for all variables, people in that province have higher baseline odds of using m-banking. A lower value (negative effect) means lower baseline odds. Since <strong>Quebec (QC)</strong> and <strong>British Columbia (BC)</strong> have the highest positive effects, we can say mobile banking is more common there, even after accounting for mental health and other variables. On the opposite end, <strong>Alberta (AB)</strong> and <strong>Newfoundland &amp; Labrador (NL)</strong> have the lowest random effects, meaning adoption is lower in these provinces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>prov_ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'NL'</span>, <span class="st">'NS'</span>, <span class="st">'NB'</span>, <span class="st">'QC'</span>, <span class="st">'ON'</span>, <span class="st">'MB'</span>, <span class="st">'SK'</span>, <span class="st">'AB'</span>, <span class="st">'BC'</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>prov_n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">24</span>, <span class="dv">35</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">59</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># random effects are from model 2 </span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.029445800</span>, <span class="fl">0.001523515</span>,<span class="sc">-</span><span class="fl">0.034782017</span>, <span class="fl">0.308732844</span>,<span class="sc">-</span><span class="fl">0.132427568</span>,<span class="sc">-</span><span class="fl">0.129533645</span>,<span class="sc">-</span><span class="fl">0.047807245</span>,<span class="sc">-</span><span class="fl">0.001728474</span>,<span class="fl">0.053000416</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">round</span>(ranefs_, <span class="dv">4</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>d_graph <span class="ot">&lt;-</span> <span class="fu">cbind</span>(prov_, prov_n, ranefs_)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>d_graph <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(d_graph)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>provs_fullnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Newfoundland and Labrador'</span>, <span class="st">'Nova Scotia'</span>, <span class="st">'New Brunswick'</span>,<span class="st">'Quebec'</span>, <span class="st">'Ontario'</span>, <span class="st">'Manitoba'</span>, <span class="st">'Saskatchewan'</span>, <span class="st">'Alberta'</span>, <span class="st">'British Columbia'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d_graph, <span class="fu">aes</span>(<span class="at">x =</span> prov_n, <span class="at">y =</span> ranefs_, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">'NL'</span>, <span class="st">'NS'</span>, <span class="st">'NB'</span>, <span class="st">'QC'</span>, <span class="st">'ON'</span>, <span class="st">'MB'</span>, <span class="st">'SK'</span>, <span class="st">'AB'</span>, <span class="st">'BC'</span>))) <span class="sc">+</span>   </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Province Code"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Random Effect"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"Province"</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">fill =</span> provs_fullnames), <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> provs_fullnames, <span class="at">name =</span> <span class="st">"province"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb56" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Effect Of Mental Health on Mobile Banking" </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Yekta Amirkhalili"</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "today"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained: false</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">    execute:</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">      eval: false </span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">      echo: true</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">      warning: false</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">      message: false</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">      error: false</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">      results: 'asis'</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co">    #css: style.css</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CSS CHANGES --&gt;</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="fu">.quarto-title</span> h1<span class="fu">.title</span> {</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.5</span><span class="dt">rem</span><span class="op">;</span> </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>h2{</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span><span class="ch">:</span><span class="fu">rgba(</span><span class="dv">128</span><span class="op">,</span> <span class="dv">170</span><span class="op">,</span> <span class="dv">156</span><span class="op">,</span> <span class="dv">0.48</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="fu">.future-idea-box</span> {</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">solid</span> <span class="fu">var(</span><span class="va">--quarto-hl-header-color</span><span class="op">,</span> <span class="cn">#86bdab</span><span class="fu">)</span><span class="op">;</span> <span class="co">/* Uses Quarto header color variable or fallback */</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">background</span><span class="ch">:</span> <span class="cn">#f9f9fc</span><span class="op">;</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="fu">.future-idea-title</span> {</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-weight</span><span class="ch">:</span> <span class="dv">bold</span><span class="op">;</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="kw">color</span><span class="ch">:</span> <span class="fu">var(</span><span class="va">--quarto-hl-header-color</span><span class="op">,</span><span class="fu">rgb(</span><span class="dv">111</span><span class="op">,</span> <span class="dv">172</span><span class="op">,</span> <span class="dv">152</span><span class="fu">))</span><span class="op">;</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin-bottom</span><span class="ch">:</span> <span class="dv">0.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.1</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a><span class="fu">.variable-card</span> {</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#447099</span><span class="op">;</span>           <span class="co">/* Choose your border color */</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">background</span><span class="ch">:</span> <span class="cn">#f5f8fa</span><span class="op">;</span>                 <span class="co">/* Light background */</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">1.2</span><span class="dt">em</span> <span class="dv">1.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  <span class="kw">box-shadow</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span> <span class="fu">rgba(</span><span class="dv">68</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">153</span><span class="op">,</span><span class="dv">0.05</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">500</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CSS CHANGES --&gt;</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Analysis </span></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>In this project, I focused on analyzing how mental health relates to mobile banking adoption.</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>I used data from the Canadian Internet Use Survey, which includes questions about digital habits, mental health, and demographics.</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>You can find the dataset <span class="co">[</span><span class="ot">here</span><span class="co">](https://abacus.library.ubc.ca/dataset.xhtml;jsessionid=334500b45ffff5190ff22e232434?persistentId=hdl%3A11272.1%2FAB2%2FNUVBX2&amp;version=&amp;q=&amp;fileTypeGroupFacet=&amp;fileAccess=Public&amp;fileSortField=name&amp;fileSortOrder=desc)</span>. </span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>I built a fixed-effects logistic regression model, grouped by <span class="in">`province`</span>, to control for regional differences as this was the sampling cluster.</span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>My main variable was self-reported mental health scores.</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>I included factors like relationship satisfaction, smartphone dependency, and social media use. </span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>I also tested interaction effects to see if these variables change the way mental health influences mobile banking use.</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>The following is a step-by-step on the coding and analysis of the project. </span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing Libraries </span></span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>Note that not all libraries may be utilized. </span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>The most important ones are <span class="in">`dplyr`</span>, <span class="in">`lme4`</span>, <span class="in">`tidyr`</span>, <span class="in">`ggplot2`</span>, <span class="in">`psych`</span>, <span class="in">`corrr`</span>, <span class="in">`haven`</span>, <span class="in">`marginaleffects`</span> and <span class="in">`margins`</span> and any related libraries to these. </span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_1}</span></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false </span></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rempsyc)</span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(weights)</span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(miscTools)</span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(systemfit)</span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(GGally)</span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(reshape2)</span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(lattice)</span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HLMdiag)</span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span>
<span id="cb56-109"><a href="#cb56-109" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb56-110"><a href="#cb56-110" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb56-113"><a href="#cb56-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb56-114"><a href="#cb56-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb56-115"><a href="#cb56-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb56-116"><a href="#cb56-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb56-117"><a href="#cb56-117" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb56-118"><a href="#cb56-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb56-119"><a href="#cb56-119" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb56-120"><a href="#cb56-120" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb56-121"><a href="#cb56-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb56-122"><a href="#cb56-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb56-123"><a href="#cb56-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb56-124"><a href="#cb56-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb56-125"><a href="#cb56-125" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb56-126"><a href="#cb56-126" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formatR)</span>
<span id="cb56-127"><a href="#cb56-127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pglm)</span>
<span id="cb56-128"><a href="#cb56-128" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(acqr)</span>
<span id="cb56-129"><a href="#cb56-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-130"><a href="#cb56-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-131"><a href="#cb56-131" aria-hidden="true" tabindex="-1"></a><span class="fu">### Introducing the CIUS 2020</span></span>
<span id="cb56-132"><a href="#cb56-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-133"><a href="#cb56-133" aria-hidden="true" tabindex="-1"></a>I first started by reading the entire PUMF file available.  </span>
<span id="cb56-134"><a href="#cb56-134" aria-hidden="true" tabindex="-1"></a>This gives you information on how the survey was set up, why, and how things were measured. </span>
<span id="cb56-135"><a href="#cb56-135" aria-hidden="true" tabindex="-1"></a>Then, I looked at the individual survey questions to see the available data, and how they were measured. </span>
<span id="cb56-136"><a href="#cb56-136" aria-hidden="true" tabindex="-1"></a>In general, questions are measured numerically were answeres follow as such:</span>
<span id="cb56-137"><a href="#cb56-137" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Yes : 1, No : 2, Valid Skip: 6, Don't Know: 7, Refusal: 8, Not Stated: 9 </span></span>
<span id="cb56-138"><a href="#cb56-138" aria-hidden="true" tabindex="-1"></a><span class="at">Of course this differs question-by-question as some questions have other answer categories and some questions (which were note used in my study) asked for numerical input from the participants (like how much did you spend online last year).</span></span>
<span id="cb56-139"><a href="#cb56-139" aria-hidden="true" tabindex="-1"></a><span class="at">To help readers understand the data, I will include the question exactly as it appears in the CIUS 2020 PUMF Data Dictionary with corresponding answer choices and codes. </span></span>
<span id="cb56-140"><a href="#cb56-140" aria-hidden="true" tabindex="-1"></a><span class="at">These will be in a blue-bordered box, and will include the Variable name (on the PUMF file), Concept, Question Body and Answers. </span></span>
<span id="cb56-141"><a href="#cb56-141" aria-hidden="true" tabindex="-1"></a><span class="at">Then I will show you in R code how I've re-coded and used the question as a model variable. </span></span>
<span id="cb56-142"><a href="#cb56-142" aria-hidden="true" tabindex="-1"></a><span class="at">The Variables I need are as follows: </span></span>
<span id="cb56-143"><a href="#cb56-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-144"><a href="#cb56-144" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mobile banking adoption (<span class="in">`mBanking`</span>)</span>
<span id="cb56-145"><a href="#cb56-145" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Age Group (<span class="in">`AGE`</span>)</span>
<span id="cb56-146"><a href="#cb56-146" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Smartphone Dependent (<span class="in">`SD`</span>)</span>
<span id="cb56-147"><a href="#cb56-147" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Income Quintile (<span class="in">`INC`</span>) </span>
<span id="cb56-148"><a href="#cb56-148" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Friendship Satisfaction (<span class="in">`FRISAT`</span>)</span>
<span id="cb56-149"><a href="#cb56-149" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mental Health (MH) </span>
<span id="cb56-150"><a href="#cb56-150" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Family Relation Satisfaction (<span class="in">`FAMSAT`</span>)</span>
<span id="cb56-151"><a href="#cb56-151" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Education Level (<span class="in">`EDU`</span>) </span>
<span id="cb56-152"><a href="#cb56-152" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Immigration Status (<span class="in">`IMM`</span>)</span>
<span id="cb56-153"><a href="#cb56-153" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Employment Status (<span class="in">`EMP`</span>)</span>
<span id="cb56-154"><a href="#cb56-154" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Family Type (<span class="in">`FAM`</span>)</span>
<span id="cb56-155"><a href="#cb56-155" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Gender (<span class="in">`SEX`</span>)</span>
<span id="cb56-156"><a href="#cb56-156" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Social Media Use (<span class="in">`SNS`</span>)</span>
<span id="cb56-157"><a href="#cb56-157" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Province (<span class="in">`province`</span>)</span>
<span id="cb56-158"><a href="#cb56-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-159"><a href="#cb56-159" aria-hidden="true" tabindex="-1"></a>The data is available in various formats. </span>
<span id="cb56-160"><a href="#cb56-160" aria-hidden="true" tabindex="-1"></a>To avoid data loss, I decided to use the <span class="in">`.dta`</span> format (SAS file).</span>
<span id="cb56-161"><a href="#cb56-161" aria-hidden="true" tabindex="-1"></a>You need the <span class="in">`haven`</span> package to read SAS files. </span>
<span id="cb56-162"><a href="#cb56-162" aria-hidden="true" tabindex="-1"></a>However, this file is 150MB in size and since I am uploading the code in my GitHub repository, I am not able to use the SAS file. </span>
<span id="cb56-163"><a href="#cb56-163" aria-hidden="true" tabindex="-1"></a>So I've saved the data in a <span class="in">`.csv`</span> file with only the columns I will need. </span>
<span id="cb56-164"><a href="#cb56-164" aria-hidden="true" tabindex="-1"></a>This is how you'd read a SAS file: </span>
<span id="cb56-165"><a href="#cb56-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_2}</span></span>
<span id="cb56-166"><a href="#cb56-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb56-167"><a href="#cb56-167" aria-hidden="true" tabindex="-1"></a>ds20 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data/cius2020_2022nov18_en.dta"</span>)</span>
<span id="cb56-168"><a href="#cb56-168" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds20</span>
<span id="cb56-169"><a href="#cb56-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-170"><a href="#cb56-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-171"><a href="#cb56-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-172"><a href="#cb56-172" aria-hidden="true" tabindex="-1"></a>Instead, I run this: </span>
<span id="cb56-173"><a href="#cb56-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_3}</span></span>
<span id="cb56-174"><a href="#cb56-174" aria-hidden="true" tabindex="-1"></a>ds10 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"ds.csv"</span>)</span>
<span id="cb56-175"><a href="#cb56-175" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds10 </span>
<span id="cb56-176"><a href="#cb56-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-177"><a href="#cb56-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-178"><a href="#cb56-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-179"><a href="#cb56-179" aria-hidden="true" tabindex="-1"></a>**Step 1. Smartphone Users** Select only those who use smartphones because the question is about "online banking" and not "mobile banking". </span>
<span id="cb56-180"><a href="#cb56-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-181"><a href="#cb56-181" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-182"><a href="#cb56-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-183"><a href="#cb56-183" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-184"><a href="#cb56-184" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-185"><a href="#cb56-185" aria-hidden="true" tabindex="-1"></a>**Variable Name:** DV_010A  </span>
<span id="cb56-186"><a href="#cb56-186" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-187"><a href="#cb56-187" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-188"><a href="#cb56-188" aria-hidden="true" tabindex="-1"></a>**Concept:** Devices used  </span>
<span id="cb56-189"><a href="#cb56-189" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-190"><a href="#cb56-190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-191"><a href="#cb56-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-192"><a href="#cb56-192" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-193"><a href="#cb56-193" aria-hidden="true" tabindex="-1"></a>During the past three months, what devices did you use to access the Internet?  </span>
<span id="cb56-194"><a href="#cb56-194" aria-hidden="true" tabindex="-1"></a>Did you use:  </span>
<span id="cb56-195"><a href="#cb56-195" aria-hidden="true" tabindex="-1"></a>*A smartphone*</span>
<span id="cb56-196"><a href="#cb56-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-197"><a href="#cb56-197" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-198"><a href="#cb56-198" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-199"><a href="#cb56-199" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Yes<span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-200"><a href="#cb56-200" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>No <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-201"><a href="#cb56-201" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Valid Skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-202"><a href="#cb56-202" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Don't Know <span class="pp">|</span> 7 <span class="pp">|</span> </span>
<span id="cb56-203"><a href="#cb56-203" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-204"><a href="#cb56-204" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Not Stated <span class="pp">|</span> 9 <span class="pp">|</span> </span>
<span id="cb56-205"><a href="#cb56-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-206"><a href="#cb56-206" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-207"><a href="#cb56-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-208"><a href="#cb56-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-209"><a href="#cb56-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_4}</span></span>
<span id="cb56-210"><a href="#cb56-210" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb56-211"><a href="#cb56-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb56-212"><a href="#cb56-212" aria-hidden="true" tabindex="-1"></a>        <span class="at">devSM =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-213"><a href="#cb56-213" aria-hidden="true" tabindex="-1"></a>            dv_010a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#yes</span></span>
<span id="cb56-214"><a href="#cb56-214" aria-hidden="true" tabindex="-1"></a>            dv_010a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co">#no</span></span>
<span id="cb56-215"><a href="#cb56-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="co">#any valid skip and not stated </span></span>
<span id="cb56-216"><a href="#cb56-216" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb56-217"><a href="#cb56-217" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-218"><a href="#cb56-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-219"><a href="#cb56-219" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb56-220"><a href="#cb56-220" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(devSM <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb56-221"><a href="#cb56-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-222"><a href="#cb56-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-223"><a href="#cb56-223" aria-hidden="true" tabindex="-1"></a>**Step 2. Mobile Banking Question** Select the outcome variable, mobile banking: </span>
<span id="cb56-224"><a href="#cb56-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-225"><a href="#cb56-225" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-226"><a href="#cb56-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-227"><a href="#cb56-227" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-228"><a href="#cb56-228" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-229"><a href="#cb56-229" aria-hidden="true" tabindex="-1"></a>**Variable Name:** UI_050D  </span>
<span id="cb56-230"><a href="#cb56-230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-231"><a href="#cb56-231" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-232"><a href="#cb56-232" aria-hidden="true" tabindex="-1"></a>**Concept:** Activities related to other online activities</span>
<span id="cb56-233"><a href="#cb56-233" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-234"><a href="#cb56-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-235"><a href="#cb56-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-236"><a href="#cb56-236" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-237"><a href="#cb56-237" aria-hidden="true" tabindex="-1"></a>During the past three months, which of the following other online activities, have you done over the Internet?</span>
<span id="cb56-238"><a href="#cb56-238" aria-hidden="true" tabindex="-1"></a>Have you:</span>
<span id="cb56-239"><a href="#cb56-239" aria-hidden="true" tabindex="-1"></a>*Conducted online banking*</span>
<span id="cb56-240"><a href="#cb56-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-241"><a href="#cb56-241" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-242"><a href="#cb56-242" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-243"><a href="#cb56-243" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Yes<span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-244"><a href="#cb56-244" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>No <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-245"><a href="#cb56-245" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Valid Skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-246"><a href="#cb56-246" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Don't Know <span class="pp">|</span> 7 <span class="pp">|</span> </span>
<span id="cb56-247"><a href="#cb56-247" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-248"><a href="#cb56-248" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>Not Stated <span class="pp">|</span> 9 <span class="pp">|</span> </span>
<span id="cb56-249"><a href="#cb56-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-250"><a href="#cb56-250" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-251"><a href="#cb56-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-252"><a href="#cb56-252" aria-hidden="true" tabindex="-1"></a>**Step 3. Select Other Model Variables** Now I will move on to selecting the predictors. </span>
<span id="cb56-253"><a href="#cb56-253" aria-hidden="true" tabindex="-1"></a>For Smartphone Dependency:</span>
<span id="cb56-254"><a href="#cb56-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-255"><a href="#cb56-255" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-256"><a href="#cb56-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-257"><a href="#cb56-257" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-258"><a href="#cb56-258" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-259"><a href="#cb56-259" aria-hidden="true" tabindex="-1"></a>**Variable Name:** SM_030A  </span>
<span id="cb56-260"><a href="#cb56-260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-261"><a href="#cb56-261" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-262"><a href="#cb56-262" aria-hidden="true" tabindex="-1"></a>**Concept:** Frequency of use of smartphone</span>
<span id="cb56-263"><a href="#cb56-263" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-264"><a href="#cb56-264" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-265"><a href="#cb56-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-266"><a href="#cb56-266" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-267"><a href="#cb56-267" aria-hidden="true" tabindex="-1"></a>In a typical day, how often do you check your smartphone?</span>
<span id="cb56-268"><a href="#cb56-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-269"><a href="#cb56-269" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-270"><a href="#cb56-270" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-271"><a href="#cb56-271" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> At least every 5 minutes <span class="pp">|</span> 01 <span class="pp">|</span> </span>
<span id="cb56-272"><a href="#cb56-272" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> At least every 15 minutes <span class="pp">|</span> 02 <span class="pp">|</span> </span>
<span id="cb56-273"><a href="#cb56-273" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> At least every 30 minutes <span class="pp">|</span> 03 <span class="pp">|</span> </span>
<span id="cb56-274"><a href="#cb56-274" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> One time per hour <span class="pp">|</span> 04 <span class="pp">|</span> </span>
<span id="cb56-275"><a href="#cb56-275" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Once a day or a few times per day <span class="pp">|</span> 05 <span class="pp">|</span> </span>
<span id="cb56-276"><a href="#cb56-276" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Less than one time per day <span class="pp">|</span> 06 <span class="pp">|</span> </span>
<span id="cb56-277"><a href="#cb56-277" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 96 <span class="pp">|</span> </span>
<span id="cb56-278"><a href="#cb56-278" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 97 <span class="pp">|</span></span>
<span id="cb56-279"><a href="#cb56-279" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 98 <span class="pp">|</span> </span>
<span id="cb56-280"><a href="#cb56-280" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 99 <span class="pp">|</span></span>
<span id="cb56-281"><a href="#cb56-281" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-282"><a href="#cb56-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-283"><a href="#cb56-283" aria-hidden="true" tabindex="-1"></a>As you can see, this one is no longer just a yes/no question, but has a few categories for answers. </span>
<span id="cb56-284"><a href="#cb56-284" aria-hidden="true" tabindex="-1"></a>Since I'm thinking of tracking "dependence", it makes sense that the more frequent checking gets a higher value. </span>
<span id="cb56-285"><a href="#cb56-285" aria-hidden="true" tabindex="-1"></a>So, this is how I code this variable: </span>
<span id="cb56-286"><a href="#cb56-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-287"><a href="#cb56-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_5}</span></span>
<span id="cb56-288"><a href="#cb56-288" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb56-289"><a href="#cb56-289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb56-290"><a href="#cb56-290" aria-hidden="true" tabindex="-1"></a>        <span class="co">#timeline : past 3 months </span></span>
<span id="cb56-291"><a href="#cb56-291" aria-hidden="true" tabindex="-1"></a>        <span class="at">mBanking =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-292"><a href="#cb56-292" aria-hidden="true" tabindex="-1"></a>            ui_050d <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Yes </span></span>
<span id="cb56-293"><a href="#cb56-293" aria-hidden="true" tabindex="-1"></a>            ui_050d <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># No </span></span>
<span id="cb56-294"><a href="#cb56-294" aria-hidden="true" tabindex="-1"></a>            <span class="at">.default =</span> <span class="sc">-</span><span class="dv">1</span> <span class="co"># valid skip, don't know, refused, not stated </span></span>
<span id="cb56-295"><a href="#cb56-295" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb56-296"><a href="#cb56-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-297"><a href="#cb56-297" aria-hidden="true" tabindex="-1"></a>        <span class="at">SD =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-298"><a href="#cb56-298" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">6</span>, <span class="co"># At least every 5 minutes </span></span>
<span id="cb56-299"><a href="#cb56-299" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co"># At least every 15 minutes </span></span>
<span id="cb56-300"><a href="#cb56-300" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="co"># At least every 30 minutes  </span></span>
<span id="cb56-301"><a href="#cb56-301" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">3</span>, <span class="co"># One time per hour  </span></span>
<span id="cb56-302"><a href="#cb56-302" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="co"># Once a day or a few times per day  </span></span>
<span id="cb56-303"><a href="#cb56-303" aria-hidden="true" tabindex="-1"></a>            sm_030a <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Less than one time per day</span></span>
<span id="cb56-304"><a href="#cb56-304" aria-hidden="true" tabindex="-1"></a>            <span class="at">.default =</span> <span class="dv">96</span> <span class="co"># Valid skip 96 , Don’t know 97 , Refusal  98, Not stated  99</span></span>
<span id="cb56-305"><a href="#cb56-305" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb56-306"><a href="#cb56-306" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-307"><a href="#cb56-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-308"><a href="#cb56-308" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SD <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb56-309"><a href="#cb56-309" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>) </span>
<span id="cb56-310"><a href="#cb56-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-311"><a href="#cb56-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-312"><a href="#cb56-312" aria-hidden="true" tabindex="-1"></a>The filters are just making sure that the skip's, don't know's, refusal's and not stated answers are dropped. </span>
<span id="cb56-313"><a href="#cb56-313" aria-hidden="true" tabindex="-1"></a>This is not too big of a loss. </span>
<span id="cb56-314"><a href="#cb56-314" aria-hidden="true" tabindex="-1"></a>There are $17,409$ rows of data. </span>
<span id="cb56-315"><a href="#cb56-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-316"><a href="#cb56-316" aria-hidden="true" tabindex="-1"></a>Friendship Satisfaction: </span>
<span id="cb56-317"><a href="#cb56-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-318"><a href="#cb56-318" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-319"><a href="#cb56-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-320"><a href="#cb56-320" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-321"><a href="#cb56-321" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-322"><a href="#cb56-322" aria-hidden="true" tabindex="-1"></a>**Variable Name:** TS_010A</span>
<span id="cb56-323"><a href="#cb56-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-324"><a href="#cb56-324" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-325"><a href="#cb56-325" aria-hidden="true" tabindex="-1"></a>**Concept:**  Satisfaction with relationships</span>
<span id="cb56-326"><a href="#cb56-326" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-327"><a href="#cb56-327" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-328"><a href="#cb56-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-329"><a href="#cb56-329" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-330"><a href="#cb56-330" aria-hidden="true" tabindex="-1"></a>In general, on a scale from 1 to 5 where 1 means «completely dissatisfied» and 5 means «completely satisfied», how satisfied are you with the relationships you have with the following people?</span>
<span id="cb56-331"><a href="#cb56-331" aria-hidden="true" tabindex="-1"></a>*Friends*</span>
<span id="cb56-332"><a href="#cb56-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-333"><a href="#cb56-333" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-334"><a href="#cb56-334" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-335"><a href="#cb56-335" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1-Completely dissatisfied <span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-336"><a href="#cb56-336" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-337"><a href="#cb56-337" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> 3 <span class="pp">|</span> </span>
<span id="cb56-338"><a href="#cb56-338" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> 4 <span class="pp">|</span> </span>
<span id="cb56-339"><a href="#cb56-339" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5- Completely satisfied <span class="pp">|</span> 5 <span class="pp">|</span> </span>
<span id="cb56-340"><a href="#cb56-340" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-341"><a href="#cb56-341" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span></span>
<span id="cb56-342"><a href="#cb56-342" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-343"><a href="#cb56-343" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span></span>
<span id="cb56-344"><a href="#cb56-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-345"><a href="#cb56-345" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-346"><a href="#cb56-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-347"><a href="#cb56-347" aria-hidden="true" tabindex="-1"></a>Family Satisfaction: </span>
<span id="cb56-348"><a href="#cb56-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-349"><a href="#cb56-349" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-350"><a href="#cb56-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-351"><a href="#cb56-351" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-352"><a href="#cb56-352" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-353"><a href="#cb56-353" aria-hidden="true" tabindex="-1"></a>**Variable Name:** TS_010B</span>
<span id="cb56-354"><a href="#cb56-354" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-355"><a href="#cb56-355" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-356"><a href="#cb56-356" aria-hidden="true" tabindex="-1"></a>**Concept:**  Satisfaction with relationships</span>
<span id="cb56-357"><a href="#cb56-357" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-358"><a href="#cb56-358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-359"><a href="#cb56-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-360"><a href="#cb56-360" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-361"><a href="#cb56-361" aria-hidden="true" tabindex="-1"></a>In general, on a scale from 1 to 5 where 1 means «completely dissatisfied» and 5 means «completely satisfied», how satisfied are you with the relationships you have with the following people?</span>
<span id="cb56-362"><a href="#cb56-362" aria-hidden="true" tabindex="-1"></a>*Relatives or family members, excluding those you live with*</span>
<span id="cb56-363"><a href="#cb56-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-364"><a href="#cb56-364" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-365"><a href="#cb56-365" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-366"><a href="#cb56-366" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1-Completely dissatisfied <span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-367"><a href="#cb56-367" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-368"><a href="#cb56-368" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> 3 <span class="pp">|</span> </span>
<span id="cb56-369"><a href="#cb56-369" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> 4 <span class="pp">|</span> </span>
<span id="cb56-370"><a href="#cb56-370" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5- Completely satisfied <span class="pp">|</span> 5 <span class="pp">|</span> </span>
<span id="cb56-371"><a href="#cb56-371" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-372"><a href="#cb56-372" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span></span>
<span id="cb56-373"><a href="#cb56-373" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-374"><a href="#cb56-374" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span></span>
<span id="cb56-375"><a href="#cb56-375" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-376"><a href="#cb56-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-377"><a href="#cb56-377" aria-hidden="true" tabindex="-1"></a>Mental Health:</span>
<span id="cb56-378"><a href="#cb56-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-379"><a href="#cb56-379" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-380"><a href="#cb56-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-381"><a href="#cb56-381" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-382"><a href="#cb56-382" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-383"><a href="#cb56-383" aria-hidden="true" tabindex="-1"></a>**Variable Name:** FD_030A </span>
<span id="cb56-384"><a href="#cb56-384" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-385"><a href="#cb56-385" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-386"><a href="#cb56-386" aria-hidden="true" tabindex="-1"></a>**Concept:**  Perceived mental health</span>
<span id="cb56-387"><a href="#cb56-387" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-388"><a href="#cb56-388" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-389"><a href="#cb56-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-390"><a href="#cb56-390" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-391"><a href="#cb56-391" aria-hidden="true" tabindex="-1"></a>In general, how is your mental health?</span>
<span id="cb56-392"><a href="#cb56-392" aria-hidden="true" tabindex="-1"></a>Would you say:</span>
<span id="cb56-393"><a href="#cb56-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-394"><a href="#cb56-394" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-395"><a href="#cb56-395" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-396"><a href="#cb56-396" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Excellent <span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-397"><a href="#cb56-397" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Very good <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-398"><a href="#cb56-398" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Good <span class="pp">|</span> 3 <span class="pp">|</span> </span>
<span id="cb56-399"><a href="#cb56-399" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Fair <span class="pp">|</span> 4 <span class="pp">|</span> </span>
<span id="cb56-400"><a href="#cb56-400" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Poor <span class="pp">|</span> 5 <span class="pp">|</span> </span>
<span id="cb56-401"><a href="#cb56-401" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-402"><a href="#cb56-402" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span></span>
<span id="cb56-403"><a href="#cb56-403" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-404"><a href="#cb56-404" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span></span>
<span id="cb56-405"><a href="#cb56-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-406"><a href="#cb56-406" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-407"><a href="#cb56-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-408"><a href="#cb56-408" aria-hidden="true" tabindex="-1"></a>Again, since I want to measure mental health in terms of how good or bad a person is, it makes sense that better moods are associated with elevated numbers (so instead of it being coded as 1, Excellent should be coded as 5). </span>
<span id="cb56-409"><a href="#cb56-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-410"><a href="#cb56-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-411"><a href="#cb56-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_6}</span></span>
<span id="cb56-412"><a href="#cb56-412" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-413"><a href="#cb56-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">FRISAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-414"><a href="#cb56-414" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#completely dissatisfied </span></span>
<span id="cb56-415"><a href="#cb56-415" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb56-416"><a href="#cb56-416" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb56-417"><a href="#cb56-417" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb56-418"><a href="#cb56-418" aria-hidden="true" tabindex="-1"></a>        ts_010a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#completely satisfied </span></span>
<span id="cb56-419"><a href="#cb56-419" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb56-420"><a href="#cb56-420" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-421"><a href="#cb56-421" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-422"><a href="#cb56-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAMSAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-423"><a href="#cb56-423" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#completely dissatisfied </span></span>
<span id="cb56-424"><a href="#cb56-424" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb56-425"><a href="#cb56-425" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb56-426"><a href="#cb56-426" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb56-427"><a href="#cb56-427" aria-hidden="true" tabindex="-1"></a>        ts_010b <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#completely satisfied </span></span>
<span id="cb56-428"><a href="#cb56-428" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb56-429"><a href="#cb56-429" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-430"><a href="#cb56-430" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-431"><a href="#cb56-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">MH =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-432"><a href="#cb56-432" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">5</span>, <span class="co">#excellent </span></span>
<span id="cb56-433"><a href="#cb56-433" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="co">#very good </span></span>
<span id="cb56-434"><a href="#cb56-434" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">3</span>, <span class="co">#good </span></span>
<span id="cb56-435"><a href="#cb56-435" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="co">#fair</span></span>
<span id="cb56-436"><a href="#cb56-436" aria-hidden="true" tabindex="-1"></a>        fd_030a <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co">#poor</span></span>
<span id="cb56-437"><a href="#cb56-437" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">6</span></span>
<span id="cb56-438"><a href="#cb56-438" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-439"><a href="#cb56-439" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-440"><a href="#cb56-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-441"><a href="#cb56-441" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb56-442"><a href="#cb56-442" aria-hidden="true" tabindex="-1"></a>    FRISAT <span class="sc">&lt;</span> <span class="dv">6</span>,</span>
<span id="cb56-443"><a href="#cb56-443" aria-hidden="true" tabindex="-1"></a>    FAMSAT <span class="sc">&lt;</span> <span class="dv">6</span>,</span>
<span id="cb56-444"><a href="#cb56-444" aria-hidden="true" tabindex="-1"></a>    MH <span class="sc">&lt;</span> <span class="dv">6</span></span>
<span id="cb56-445"><a href="#cb56-445" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-446"><a href="#cb56-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-447"><a href="#cb56-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-448"><a href="#cb56-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-449"><a href="#cb56-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-450"><a href="#cb56-450" aria-hidden="true" tabindex="-1"></a>Social Media use: </span>
<span id="cb56-451"><a href="#cb56-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-452"><a href="#cb56-452" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-453"><a href="#cb56-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-454"><a href="#cb56-454" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-455"><a href="#cb56-455" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-456"><a href="#cb56-456" aria-hidden="true" tabindex="-1"></a>**Variable Name:** UI_010C</span>
<span id="cb56-457"><a href="#cb56-457" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-458"><a href="#cb56-458" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-459"><a href="#cb56-459" aria-hidden="true" tabindex="-1"></a>**Concept:**  Activities related to communication</span>
<span id="cb56-460"><a href="#cb56-460" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-461"><a href="#cb56-461" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-462"><a href="#cb56-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-463"><a href="#cb56-463" aria-hidden="true" tabindex="-1"></a>**Question Text:**  </span>
<span id="cb56-464"><a href="#cb56-464" aria-hidden="true" tabindex="-1"></a>During the past three months, which of the following activities, related to communication, have you done over the Internet?</span>
<span id="cb56-465"><a href="#cb56-465" aria-hidden="true" tabindex="-1"></a>Have you:</span>
<span id="cb56-466"><a href="#cb56-466" aria-hidden="true" tabindex="-1"></a>*Used social networking websites or apps*</span>
<span id="cb56-467"><a href="#cb56-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-468"><a href="#cb56-468" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**<span class="pp">|</span></span>
<span id="cb56-469"><a href="#cb56-469" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|</span></span>
<span id="cb56-470"><a href="#cb56-470" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Yes <span class="pp">|</span> 1 <span class="pp">|</span></span>
<span id="cb56-471"><a href="#cb56-471" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> No <span class="pp">|</span> 2 <span class="pp">|</span></span>
<span id="cb56-472"><a href="#cb56-472" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> </span>
<span id="cb56-473"><a href="#cb56-473" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span></span>
<span id="cb56-474"><a href="#cb56-474" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> </span>
<span id="cb56-475"><a href="#cb56-475" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span></span>
<span id="cb56-476"><a href="#cb56-476" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-477"><a href="#cb56-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-478"><a href="#cb56-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_7}</span></span>
<span id="cb56-479"><a href="#cb56-479" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-480"><a href="#cb56-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">SNS =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-481"><a href="#cb56-481" aria-hidden="true" tabindex="-1"></a>        ui_010c <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># yes </span></span>
<span id="cb56-482"><a href="#cb56-482" aria-hidden="true" tabindex="-1"></a>        ui_010c <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># no </span></span>
<span id="cb56-483"><a href="#cb56-483" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="dv">3</span></span>
<span id="cb56-484"><a href="#cb56-484" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-485"><a href="#cb56-485" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-486"><a href="#cb56-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-487"><a href="#cb56-487" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb56-488"><a href="#cb56-488" aria-hidden="true" tabindex="-1"></a>    SNS <span class="sc">&lt;</span> <span class="dv">3</span></span>
<span id="cb56-489"><a href="#cb56-489" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-490"><a href="#cb56-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-491"><a href="#cb56-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-492"><a href="#cb56-492" aria-hidden="true" tabindex="-1"></a>**Step 4. Gather Demographic and Other Information** Here, I will select some demographic information. </span>
<span id="cb56-493"><a href="#cb56-493" aria-hidden="true" tabindex="-1"></a>Since these are not direct questions but information retrieved from other sources (such as postal codes for province), some of them do not have Skips/Don't Know/Refusal/Not Stated answers. </span>
<span id="cb56-494"><a href="#cb56-494" aria-hidden="true" tabindex="-1"></a>If they have, I have added those to the cards. </span>
<span id="cb56-495"><a href="#cb56-495" aria-hidden="true" tabindex="-1"></a>I have also added a frequency column for these variables only to show you the demographic distribution of the sample (not weighted).</span>
<span id="cb56-496"><a href="#cb56-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-497"><a href="#cb56-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-498"><a href="#cb56-498" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-499"><a href="#cb56-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-500"><a href="#cb56-500" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-501"><a href="#cb56-501" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-502"><a href="#cb56-502" aria-hidden="true" tabindex="-1"></a>**Variable Name:** PROVINCE </span>
<span id="cb56-503"><a href="#cb56-503" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-504"><a href="#cb56-504" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-505"><a href="#cb56-505" aria-hidden="true" tabindex="-1"></a>**Concept:**  PROVINCE</span>
<span id="cb56-506"><a href="#cb56-506" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-507"><a href="#cb56-507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-508"><a href="#cb56-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-509"><a href="#cb56-509" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-510"><a href="#cb56-510" aria-hidden="true" tabindex="-1"></a>Information derived using postal codes.</span>
<span id="cb56-511"><a href="#cb56-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-512"><a href="#cb56-512" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-513"><a href="#cb56-513" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-514"><a href="#cb56-514" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Newfoundland and Labrador <span class="pp">|</span> 10 <span class="pp">|</span> 950 <span class="pp">|</span></span>
<span id="cb56-515"><a href="#cb56-515" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Prince Edward Island <span class="pp">|</span> 11 <span class="pp">|</span> 1,154 <span class="pp">|</span></span>
<span id="cb56-516"><a href="#cb56-516" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Nova Scotia <span class="pp">|</span> 12 <span class="pp">|</span> 1,181 <span class="pp">|</span> </span>
<span id="cb56-517"><a href="#cb56-517" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> New Brunswick <span class="pp">|</span> 13 <span class="pp">|</span> 1,223 <span class="pp">|</span></span>
<span id="cb56-518"><a href="#cb56-518" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quebec <span class="pp">|</span> 24 <span class="pp">|</span> 3,911 <span class="pp">|</span></span>
<span id="cb56-519"><a href="#cb56-519" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Ontario <span class="pp">|</span> 35 <span class="pp">|</span> 3,719 <span class="pp">|</span> </span>
<span id="cb56-520"><a href="#cb56-520" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Manitoba <span class="pp">|</span> 46 <span class="pp">|</span> 973 <span class="pp">|</span> </span>
<span id="cb56-521"><a href="#cb56-521" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Saskatchewan <span class="pp">|</span> 47 <span class="pp">|</span> 979 <span class="pp">|</span> </span>
<span id="cb56-522"><a href="#cb56-522" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Alberta <span class="pp">|</span> 48 <span class="pp">|</span> 1,365 <span class="pp">|</span> </span>
<span id="cb56-523"><a href="#cb56-523" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> British Columbia <span class="pp">|</span> 59 <span class="pp">|</span> 1,954 <span class="pp">|</span> </span>
<span id="cb56-524"><a href="#cb56-524" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-525"><a href="#cb56-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-526"><a href="#cb56-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-527"><a href="#cb56-527" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-528"><a href="#cb56-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-529"><a href="#cb56-529" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-530"><a href="#cb56-530" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-531"><a href="#cb56-531" aria-hidden="true" tabindex="-1"></a>**Variable Name:** AGE_GRP</span>
<span id="cb56-532"><a href="#cb56-532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-533"><a href="#cb56-533" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-534"><a href="#cb56-534" aria-hidden="true" tabindex="-1"></a>**Concept:**  Age Groups – Derived variable</span>
<span id="cb56-535"><a href="#cb56-535" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-536"><a href="#cb56-536" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-537"><a href="#cb56-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-538"><a href="#cb56-538" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-539"><a href="#cb56-539" aria-hidden="true" tabindex="-1"></a>Derived from age of persons in the household</span>
<span id="cb56-540"><a href="#cb56-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-541"><a href="#cb56-541" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-542"><a href="#cb56-542" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-543"><a href="#cb56-543" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>15 to 24 years <span class="pp">|</span> 01 <span class="pp">|</span> 828 <span class="pp">|</span></span>
<span id="cb56-544"><a href="#cb56-544" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>25 to 34 years <span class="pp">|</span> 02 <span class="pp">|</span> 1,805 <span class="pp">|</span></span>
<span id="cb56-545"><a href="#cb56-545" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>35 to 44 years <span class="pp">|</span> 03 <span class="pp">|</span> 2,520 <span class="pp">|</span></span>
<span id="cb56-546"><a href="#cb56-546" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>45 to 54 years <span class="pp">|</span> 04 <span class="pp">|</span> 2,469 <span class="pp">|</span></span>
<span id="cb56-547"><a href="#cb56-547" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>55 to 64 years <span class="pp">|</span> 05 <span class="pp">|</span> 3,889 <span class="pp">|</span></span>
<span id="cb56-548"><a href="#cb56-548" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>65 years and over <span class="pp">|</span> 06 <span class="pp">|</span> 5,898 <span class="pp">|</span></span>
<span id="cb56-549"><a href="#cb56-549" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-550"><a href="#cb56-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-551"><a href="#cb56-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-552"><a href="#cb56-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-553"><a href="#cb56-553" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-554"><a href="#cb56-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-555"><a href="#cb56-555" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-556"><a href="#cb56-556" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-557"><a href="#cb56-557" aria-hidden="true" tabindex="-1"></a>**Variable Name:** GENDER</span>
<span id="cb56-558"><a href="#cb56-558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-559"><a href="#cb56-559" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-560"><a href="#cb56-560" aria-hidden="true" tabindex="-1"></a>**Concept:**  Gender - Derived variable</span>
<span id="cb56-561"><a href="#cb56-561" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-562"><a href="#cb56-562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-563"><a href="#cb56-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-564"><a href="#cb56-564" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-565"><a href="#cb56-565" aria-hidden="true" tabindex="-1"></a>Refers to current gender which may be different from sex assigned at birth and may be different from what is indicated on legal documents. For data quality and confidentiality reasons, and because of the small population being measured, the dissemination of data according to ’Non binary’ Gender is not possible for this statistical program. So, this release uses a gender variable with only two categories. This variable is derived by looking at a large number of demographic characteristics from the respondent, it allows us to disseminate data on Gender that is reliable and unbiased.</span>
<span id="cb56-566"><a href="#cb56-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-567"><a href="#cb56-567" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-568"><a href="#cb56-568" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-569"><a href="#cb56-569" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Male <span class="pp">|</span> 1 <span class="pp">|</span> 8,126 <span class="pp">|</span></span>
<span id="cb56-570"><a href="#cb56-570" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Female <span class="pp">|</span> 2 <span class="pp">|</span> 9,283 <span class="pp">|</span></span>
<span id="cb56-571"><a href="#cb56-571" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-572"><a href="#cb56-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-573"><a href="#cb56-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-574"><a href="#cb56-574" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-575"><a href="#cb56-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-576"><a href="#cb56-576" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-577"><a href="#cb56-577" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-578"><a href="#cb56-578" aria-hidden="true" tabindex="-1"></a>**Variable Name:** EMP</span>
<span id="cb56-579"><a href="#cb56-579" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-580"><a href="#cb56-580" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-581"><a href="#cb56-581" aria-hidden="true" tabindex="-1"></a>**Concept:**  Employment status - Derived variable</span>
<span id="cb56-582"><a href="#cb56-582" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-583"><a href="#cb56-583" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-584"><a href="#cb56-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-585"><a href="#cb56-585" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-586"><a href="#cb56-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-587"><a href="#cb56-587" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-588"><a href="#cb56-588" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-589"><a href="#cb56-589" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Employed <span class="pp">|</span> 1 <span class="pp">|</span> 8,451 <span class="pp">|</span></span>
<span id="cb56-590"><a href="#cb56-590" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not Employed <span class="pp">|</span> 2 <span class="pp">|</span> 8,177 <span class="pp">|</span></span>
<span id="cb56-591"><a href="#cb56-591" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid Skip <span class="pp">|</span> 6 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-592"><a href="#cb56-592" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't Know <span class="pp">|</span> 7 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-593"><a href="#cb56-593" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-594"><a href="#cb56-594" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not Stated <span class="pp">|</span> 9 <span class="pp">|</span> 781 <span class="pp">|</span></span>
<span id="cb56-595"><a href="#cb56-595" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-596"><a href="#cb56-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-597"><a href="#cb56-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-598"><a href="#cb56-598" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-599"><a href="#cb56-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-600"><a href="#cb56-600" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-601"><a href="#cb56-601" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-602"><a href="#cb56-602" aria-hidden="true" tabindex="-1"></a>**Variable Name:** G_EDU</span>
<span id="cb56-603"><a href="#cb56-603" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-604"><a href="#cb56-604" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-605"><a href="#cb56-605" aria-hidden="true" tabindex="-1"></a>**Concept:**  Highest certificate - Derived variable</span>
<span id="cb56-606"><a href="#cb56-606" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-607"><a href="#cb56-607" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-608"><a href="#cb56-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-609"><a href="#cb56-609" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-610"><a href="#cb56-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-611"><a href="#cb56-611" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-612"><a href="#cb56-612" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-613"><a href="#cb56-613" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> High school or less <span class="pp">|</span> 1 <span class="pp">|</span> 5,746 <span class="pp">|</span></span>
<span id="cb56-614"><a href="#cb56-614" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Some post-secondary (incl. univ certificate) <span class="pp">|</span> 2 <span class="pp">|</span> 5,866 <span class="pp">|</span></span>
<span id="cb56-615"><a href="#cb56-615" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> University degree <span class="pp">|</span> 3 <span class="pp">|</span> 4,889 <span class="pp">|</span> </span>
<span id="cb56-616"><a href="#cb56-616" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-617"><a href="#cb56-617" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-618"><a href="#cb56-618" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> 0 <span class="pp">|</span> </span>
<span id="cb56-619"><a href="#cb56-619" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span> 908 <span class="pp">|</span></span>
<span id="cb56-620"><a href="#cb56-620" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-621"><a href="#cb56-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-622"><a href="#cb56-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-623"><a href="#cb56-623" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-624"><a href="#cb56-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-625"><a href="#cb56-625" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-626"><a href="#cb56-626" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-627"><a href="#cb56-627" aria-hidden="true" tabindex="-1"></a>**Variable Name:** G_HCOMP</span>
<span id="cb56-628"><a href="#cb56-628" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-629"><a href="#cb56-629" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-630"><a href="#cb56-630" aria-hidden="true" tabindex="-1"></a>**Concept:**  Type of household - Derived variable</span>
<span id="cb56-631"><a href="#cb56-631" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-632"><a href="#cb56-632" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-633"><a href="#cb56-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-634"><a href="#cb56-634" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-635"><a href="#cb56-635" aria-hidden="true" tabindex="-1"></a>This derived variable indicates the household composition. It was derived using RRS_Q12 (number of persons in the household), RR_020CA (age of persons in the household) and RR_040AA (relationship of the respondent with the other members of the household).</span>
<span id="cb56-636"><a href="#cb56-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-637"><a href="#cb56-637" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-638"><a href="#cb56-638" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-639"><a href="#cb56-639" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Family household with children under 18 <span class="pp">|</span> 1 <span class="pp">|</span> 3,700 <span class="pp">|</span> </span>
<span id="cb56-640"><a href="#cb56-640" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Family household without children under 18 <span class="pp">|</span> 2 <span class="pp">|</span> 8,299 <span class="pp">|</span></span>
<span id="cb56-641"><a href="#cb56-641" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Single person household <span class="pp">|</span> 3 <span class="pp">|</span> 4,837 <span class="pp">|</span></span>
<span id="cb56-642"><a href="#cb56-642" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Other household type <span class="pp">|</span> 4 <span class="pp">|</span> 414 <span class="pp">|</span> </span>
<span id="cb56-643"><a href="#cb56-643" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid skip <span class="pp">|</span> 6 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-644"><a href="#cb56-644" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't know <span class="pp">|</span> 7 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-645"><a href="#cb56-645" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> 0 <span class="pp">|</span> </span>
<span id="cb56-646"><a href="#cb56-646" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not stated <span class="pp">|</span> 9 <span class="pp">|</span> 159 <span class="pp">|</span></span>
<span id="cb56-647"><a href="#cb56-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-648"><a href="#cb56-648" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-649"><a href="#cb56-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-650"><a href="#cb56-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-651"><a href="#cb56-651" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-652"><a href="#cb56-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-653"><a href="#cb56-653" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-654"><a href="#cb56-654" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-655"><a href="#cb56-655" aria-hidden="true" tabindex="-1"></a>**Variable Name:** HINCQUIN</span>
<span id="cb56-656"><a href="#cb56-656" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-657"><a href="#cb56-657" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-658"><a href="#cb56-658" aria-hidden="true" tabindex="-1"></a>**Concept:**  Census family income quintile - Derived variable</span>
<span id="cb56-659"><a href="#cb56-659" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-660"><a href="#cb56-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-661"><a href="#cb56-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-662"><a href="#cb56-662" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-663"><a href="#cb56-663" aria-hidden="true" tabindex="-1"></a>Information derived using HINC. In order to obtain equal weighted counts in each category, cases with incomes equal to the category cutoffs were randomly assigned to one of the two categories on either side of the cutoff.</span>
<span id="cb56-664"><a href="#cb56-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-665"><a href="#cb56-665" aria-hidden="true" tabindex="-1"></a>**Source:** Annual Income Estimates for Census Families and Individuals (T1 Family File)</span>
<span id="cb56-666"><a href="#cb56-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-667"><a href="#cb56-667" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-668"><a href="#cb56-668" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-669"><a href="#cb56-669" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintile 1 - $\leq$ $44,119 <span class="pp">|</span> 1 <span class="pp">|</span> 4,200 <span class="pp">|</span> </span>
<span id="cb56-670"><a href="#cb56-670" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintile 2 - $44,120 - $75,321 <span class="pp">|</span> 2 <span class="pp">|</span> 3,911 <span class="pp">|</span></span>
<span id="cb56-671"><a href="#cb56-671" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintile 3 - $75,322 - $109,431 <span class="pp">|</span> 3 <span class="pp">|</span> 3,394 <span class="pp">|</span></span>
<span id="cb56-672"><a href="#cb56-672" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintile 4 - $109,432 - $162,799 <span class="pp">|</span> 4 <span class="pp">|</span> 3,185 <span class="pp">|</span></span>
<span id="cb56-673"><a href="#cb56-673" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintile 5 - $\geq$ $162,800 <span class="pp">|</span> 5 <span class="pp">|</span> 2,719 <span class="pp">|</span></span>
<span id="cb56-674"><a href="#cb56-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-675"><a href="#cb56-675" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-676"><a href="#cb56-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-677"><a href="#cb56-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-678"><a href="#cb56-678" aria-hidden="true" tabindex="-1"></a>::::: {.variable-card}</span>
<span id="cb56-679"><a href="#cb56-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-680"><a href="#cb56-680" aria-hidden="true" tabindex="-1"></a>::: {.columns}</span>
<span id="cb56-681"><a href="#cb56-681" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-682"><a href="#cb56-682" aria-hidden="true" tabindex="-1"></a>**Variable Name:** IMM_GSTA</span>
<span id="cb56-683"><a href="#cb56-683" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-684"><a href="#cb56-684" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb56-685"><a href="#cb56-685" aria-hidden="true" tabindex="-1"></a>**Concept:**  Immigrant status</span>
<span id="cb56-686"><a href="#cb56-686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-687"><a href="#cb56-687" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-688"><a href="#cb56-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-689"><a href="#cb56-689" aria-hidden="true" tabindex="-1"></a>**Note:**  </span>
<span id="cb56-690"><a href="#cb56-690" aria-hidden="true" tabindex="-1"></a>Landed immigrants are permanent residents who have indicated a year of landing in Canada since 1980. Variable derived from LANDING_YEAR, IMDB.</span>
<span id="cb56-691"><a href="#cb56-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-692"><a href="#cb56-692" aria-hidden="true" tabindex="-1"></a>**Source:** Longitudinal Immigration Database (IMDB)</span>
<span id="cb56-693"><a href="#cb56-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-694"><a href="#cb56-694" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>**Answer Categories**|**Code**|**Frequency**<span class="pp">|</span></span>
<span id="cb56-695"><a href="#cb56-695" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|--------|-------------|</span></span>
<span id="cb56-696"><a href="#cb56-696" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Landed immigrant <span class="pp">|</span> 1 <span class="pp">|</span> 1,696 <span class="pp">|</span></span>
<span id="cb56-697"><a href="#cb56-697" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Non-landed immigrant <span class="pp">|</span> 2 <span class="pp">|</span> 15,701 <span class="pp">|</span></span>
<span id="cb56-698"><a href="#cb56-698" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Valid Skip <span class="pp">|</span> 6 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-699"><a href="#cb56-699" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Don't Know <span class="pp">|</span> 7 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-700"><a href="#cb56-700" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Refusal <span class="pp">|</span> 8 <span class="pp">|</span> 0 <span class="pp">|</span></span>
<span id="cb56-701"><a href="#cb56-701" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Not Stated <span class="pp">|</span> 9 <span class="pp">|</span> 12 <span class="pp">|</span></span>
<span id="cb56-702"><a href="#cb56-702" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb56-703"><a href="#cb56-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-704"><a href="#cb56-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-705"><a href="#cb56-705" aria-hidden="true" tabindex="-1"></a>Variable <span class="in">`pumfid`</span> is just a unique identifier. </span>
<span id="cb56-706"><a href="#cb56-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-707"><a href="#cb56-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-708"><a href="#cb56-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_1119}</span></span>
<span id="cb56-709"><a href="#cb56-709" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-710"><a href="#cb56-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> pumfid,</span>
<span id="cb56-711"><a href="#cb56-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">province =</span> province, </span>
<span id="cb56-712"><a href="#cb56-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE =</span> <span class="fu">as.integer</span>(age_grp),</span>
<span id="cb56-713"><a href="#cb56-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">SEX =</span> gender,</span>
<span id="cb56-714"><a href="#cb56-714" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMP =</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-715"><a href="#cb56-715" aria-hidden="true" tabindex="-1"></a>        emp <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb56-716"><a href="#cb56-716" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb56-717"><a href="#cb56-717" aria-hidden="true" tabindex="-1"></a>        emp</span>
<span id="cb56-718"><a href="#cb56-718" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-719"><a href="#cb56-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDU =</span> g_edu,</span>
<span id="cb56-720"><a href="#cb56-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAM =</span> g_hcomp, </span>
<span id="cb56-721"><a href="#cb56-721" aria-hidden="true" tabindex="-1"></a>    <span class="at">IMM =</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-722"><a href="#cb56-722" aria-hidden="true" tabindex="-1"></a>        imm_gsta <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb56-723"><a href="#cb56-723" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb56-724"><a href="#cb56-724" aria-hidden="true" tabindex="-1"></a>        imm_gsta</span>
<span id="cb56-725"><a href="#cb56-725" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-726"><a href="#cb56-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">INC =</span> hincquin</span>
<span id="cb56-727"><a href="#cb56-727" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-728"><a href="#cb56-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-729"><a href="#cb56-729" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb56-730"><a href="#cb56-730" aria-hidden="true" tabindex="-1"></a>    SNS <span class="sc">&lt;</span> <span class="dv">3</span>,</span>
<span id="cb56-731"><a href="#cb56-731" aria-hidden="true" tabindex="-1"></a>    EMP <span class="sc">&lt;</span> <span class="dv">3</span>,</span>
<span id="cb56-732"><a href="#cb56-732" aria-hidden="true" tabindex="-1"></a>    FAM <span class="sc">&lt;</span> <span class="dv">5</span>,</span>
<span id="cb56-733"><a href="#cb56-733" aria-hidden="true" tabindex="-1"></a>    IMM <span class="sc">&lt;</span> <span class="dv">3</span></span>
<span id="cb56-734"><a href="#cb56-734" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-735"><a href="#cb56-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-736"><a href="#cb56-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-737"><a href="#cb56-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-738"><a href="#cb56-738" aria-hidden="true" tabindex="-1"></a>**Step 5. Selecting The Variables From Data Set**</span>
<span id="cb56-739"><a href="#cb56-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-740"><a href="#cb56-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_2119}</span></span>
<span id="cb56-741"><a href="#cb56-741" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb56-742"><a href="#cb56-742" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(id, </span>
<span id="cb56-743"><a href="#cb56-743" aria-hidden="true" tabindex="-1"></a>                  mBanking, SD, FAMSAT, FRISAT, MH, SNS,</span>
<span id="cb56-744"><a href="#cb56-744" aria-hidden="true" tabindex="-1"></a>                  province, AGE, SEX, EMP, EDU,</span>
<span id="cb56-745"><a href="#cb56-745" aria-hidden="true" tabindex="-1"></a>                  FAM, IMM, INC, wtpg)</span>
<span id="cb56-746"><a href="#cb56-746" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb56-747"><a href="#cb56-747" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb56-748"><a href="#cb56-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-749"><a href="#cb56-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-750"><a href="#cb56-750" aria-hidden="true" tabindex="-1"></a>Size of the dataset: </span>
<span id="cb56-751"><a href="#cb56-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_3119}</span></span>
<span id="cb56-752"><a href="#cb56-752" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ds)</span>
<span id="cb56-753"><a href="#cb56-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-754"><a href="#cb56-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-755"><a href="#cb56-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-756"><a href="#cb56-756" aria-hidden="true" tabindex="-1"></a><span class="fu">### EXPLORING DATA </span></span>
<span id="cb56-757"><a href="#cb56-757" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-758"><a href="#cb56-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_4119}</span></span>
<span id="cb56-759"><a href="#cb56-759" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(ds, <span class="at">type =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(n, mean, sd, median, min, max)</span>
<span id="cb56-760"><a href="#cb56-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-761"><a href="#cb56-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-762"><a href="#cb56-762" aria-hidden="true" tabindex="-1"></a>Seems like it's kind of rare for those that use m-banking to have lower MH scores.</span>
<span id="cb56-763"><a href="#cb56-763" aria-hidden="true" tabindex="-1"></a>Descriptive statistics:</span>
<span id="cb56-764"><a href="#cb56-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-765"><a href="#cb56-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_5119}</span></span>
<span id="cb56-766"><a href="#cb56-766" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data    =</span> ds,</span>
<span id="cb56-767"><a href="#cb56-767" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x   =</span> SD,</span>
<span id="cb56-768"><a href="#cb56-768" aria-hidden="true" tabindex="-1"></a>           <span class="at">y   =</span> wtpg,</span>
<span id="cb56-769"><a href="#cb56-769" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">as.factor</span>(MH)))<span class="sc">+</span> </span>
<span id="cb56-770"><a href="#cb56-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-771"><a href="#cb56-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span>  </span>
<span id="cb56-772"><a href="#cb56-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Smartphone Dependency"</span>, </span>
<span id="cb56-773"><a href="#cb56-773" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Weight"</span>, </span>
<span id="cb56-774"><a href="#cb56-774" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"MH"</span>) <span class="sc">+</span> </span>
<span id="cb56-775"><a href="#cb56-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb56-776"><a href="#cb56-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-777"><a href="#cb56-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-778"><a href="#cb56-778" aria-hidden="true" tabindex="-1"></a>Checking Na's:</span>
<span id="cb56-779"><a href="#cb56-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_6119}</span></span>
<span id="cb56-780"><a href="#cb56-780" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(ds))</span>
<span id="cb56-781"><a href="#cb56-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-782"><a href="#cb56-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-783"><a href="#cb56-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-784"><a href="#cb56-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_7119}</span></span>
<span id="cb56-785"><a href="#cb56-785" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ds)</span>
<span id="cb56-786"><a href="#cb56-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-787"><a href="#cb56-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-788"><a href="#cb56-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploring Relations</span></span>
<span id="cb56-789"><a href="#cb56-789" aria-hidden="true" tabindex="-1"></a>Visualizng the relationship between Mental Health and M-banking:</span>
<span id="cb56-790"><a href="#cb56-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-791"><a href="#cb56-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_8119}</span></span>
<span id="cb56-792"><a href="#cb56-792" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ds, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-793"><a href="#cb56-793" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-794"><a href="#cb56-794" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(mBanking)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-795"><a href="#cb56-795" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb56-796"><a href="#cb56-796" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-797"><a href="#cb56-797" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Frequencies"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Mbanking"</span>)</span>
<span id="cb56-798"><a href="#cb56-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-799"><a href="#cb56-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-800"><a href="#cb56-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-801"><a href="#cb56-801" aria-hidden="true" tabindex="-1"></a>MH and controls: AGE, SEX, EMP, EDU, FAM, IMM, INC</span>
<span id="cb56-802"><a href="#cb56-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-803"><a href="#cb56-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_9, fig.width=15, fig.height=10}</span></span>
<span id="cb56-804"><a href="#cb56-804" aria-hidden="true" tabindex="-1"></a>gg_fam <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FAM))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FAMILY'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-805"><a href="#cb56-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-806"><a href="#cb56-806" aria-hidden="true" tabindex="-1"></a>gg_age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(AGE))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'AGE'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-807"><a href="#cb56-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-808"><a href="#cb56-808" aria-hidden="true" tabindex="-1"></a>gg_edu <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(EDU))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'EDU'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-809"><a href="#cb56-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-810"><a href="#cb56-810" aria-hidden="true" tabindex="-1"></a>gg_inc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(INC))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'INC'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-811"><a href="#cb56-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-812"><a href="#cb56-812" aria-hidden="true" tabindex="-1"></a>gg_sex <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SEX))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SEX'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-813"><a href="#cb56-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-814"><a href="#cb56-814" aria-hidden="true" tabindex="-1"></a>gg_emp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(EMP))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'EMP'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-815"><a href="#cb56-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-816"><a href="#cb56-816" aria-hidden="true" tabindex="-1"></a>gg_imm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(IMM))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'Immigrant'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-817"><a href="#cb56-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-818"><a href="#cb56-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-819"><a href="#cb56-819" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb56-820"><a href="#cb56-820" aria-hidden="true" tabindex="-1"></a>    gg_fam, gg_age, gg_edu, gg_inc, gg_sex, gg_emp, gg_imm,</span>
<span id="cb56-821"><a href="#cb56-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FAM"</span>, <span class="st">"AGE"</span>, <span class="st">"EDU"</span>, <span class="st">"INC"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"IMM"</span>),</span>
<span id="cb56-822"><a href="#cb56-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb56-823"><a href="#cb56-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span></span>
<span id="cb56-824"><a href="#cb56-824" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-825"><a href="#cb56-825" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb56-826"><a href="#cb56-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-827"><a href="#cb56-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-828"><a href="#cb56-828" aria-hidden="true" tabindex="-1"></a>MH and other variables: SD, FAMSAT, FRISAT, SNS </span>
<span id="cb56-829"><a href="#cb56-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-830"><a href="#cb56-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_10, fig.width=15, fig.height=10}</span></span>
<span id="cb56-831"><a href="#cb56-831" aria-hidden="true" tabindex="-1"></a>gg_frisat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FRISAT))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FRISAT'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-832"><a href="#cb56-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-833"><a href="#cb56-833" aria-hidden="true" tabindex="-1"></a>gg_famsat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'FAMSAT'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-834"><a href="#cb56-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-835"><a href="#cb56-835" aria-hidden="true" tabindex="-1"></a>gg_sd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SD))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SD'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-836"><a href="#cb56-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-837"><a href="#cb56-837" aria-hidden="true" tabindex="-1"></a>gg_sns <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds , <span class="fu">aes</span>(MH, <span class="at">fill =</span> <span class="fu">as.factor</span>(SNS))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mental Health"</span>, <span class="at">y =</span> <span class="st">"Percentage (fill)"</span>, <span class="at">fill =</span> <span class="st">'SNS'</span>) <span class="sc">+</span> <span class="fu">fill_palette</span>(<span class="st">"Pastel1"</span>)</span>
<span id="cb56-838"><a href="#cb56-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-839"><a href="#cb56-839" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb56-840"><a href="#cb56-840" aria-hidden="true" tabindex="-1"></a>    gg_frisat, gg_famsat, gg_sd, gg_sns,</span>
<span id="cb56-841"><a href="#cb56-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FRISAT"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"SD"</span>, <span class="st">"SNS"</span>),</span>
<span id="cb56-842"><a href="#cb56-842" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb56-843"><a href="#cb56-843" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb56-844"><a href="#cb56-844" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-845"><a href="#cb56-845" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb56-846"><a href="#cb56-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-847"><a href="#cb56-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-848"><a href="#cb56-848" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation Matrix </span></span>
<span id="cb56-849"><a href="#cb56-849" aria-hidden="true" tabindex="-1"></a>All variables </span>
<span id="cb56-850"><a href="#cb56-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-851"><a href="#cb56-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_11}</span></span>
<span id="cb56-852"><a href="#cb56-852" aria-hidden="true" tabindex="-1"></a>sle <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(mBanking, SD, FAMSAT, FRISAT, SNS, AGE, SEX, EMP, EDU, FAM, INC, MH)</span>
<span id="cb56-853"><a href="#cb56-853" aria-hidden="true" tabindex="-1"></a>corM <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(sle))</span>
<span id="cb56-854"><a href="#cb56-854" aria-hidden="true" tabindex="-1"></a>reg_corM <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(corM<span class="sc">$</span>r)</span>
<span id="cb56-855"><a href="#cb56-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-856"><a href="#cb56-856" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(reg_corM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mBanking"</span>, <span class="st">"SD"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"FRISAT"</span>, <span class="st">"SNS"</span>, <span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"EDU"</span>, <span class="st">"FAM"</span>, <span class="st">"INC"</span>, <span class="st">"MH"</span>)</span>
<span id="cb56-857"><a href="#cb56-857" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb56-858"><a href="#cb56-858" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(reg_corM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mBanking"</span>, <span class="st">"SD"</span>, <span class="st">"FAMSAT"</span>, <span class="st">"FRISAT"</span>, <span class="st">"SNS"</span>, <span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"EMP"</span>, <span class="st">"EDU"</span>, <span class="st">"FAM"</span>, <span class="st">"INC"</span>, <span class="st">"MH"</span>)</span>
<span id="cb56-859"><a href="#cb56-859" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb56-860"><a href="#cb56-860" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(reg_corM, <span class="at">p.mat =</span> corM<span class="sc">$</span>P, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">insig =</span> <span class="st">'label_sig'</span>, <span class="at">sig.level =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>), <span class="at">pch.cex =</span> <span class="fl">0.9</span>, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> <span class="dv">1</span>, <span class="at">diag =</span> F, <span class="at">col =</span> corrplot<span class="sc">::</span><span class="fu">COL2</span>(<span class="st">'PuOr'</span>))</span>
<span id="cb56-861"><a href="#cb56-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-862"><a href="#cb56-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-863"><a href="#cb56-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-864"><a href="#cb56-864" aria-hidden="true" tabindex="-1"></a><span class="in">`FRISAT`</span> and <span class="in">`FAMSAT`</span> are obviously highly correlated. I'll combine them into a new variable called <span class="in">`RS`</span> for Relationship satisfaction.</span>
<span id="cb56-865"><a href="#cb56-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-866"><a href="#cb56-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_12}</span></span>
<span id="cb56-867"><a href="#cb56-867" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-868"><a href="#cb56-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">RS =</span> FAMSAT <span class="sc">+</span> FRISAT</span>
<span id="cb56-869"><a href="#cb56-869" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-870"><a href="#cb56-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-871"><a href="#cb56-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-872"><a href="#cb56-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-873"><a href="#cb56-873" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Showing that it's ok to replace FAMSAT + FRISAT = RS </span></span>
<span id="cb56-874"><a href="#cb56-874" aria-hidden="true" tabindex="-1"></a>Using a Likelihood Ratio Test: </span>
<span id="cb56-875"><a href="#cb56-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_13}</span></span>
<span id="cb56-876"><a href="#cb56-876" aria-hidden="true" tabindex="-1"></a>model_famsatfrisat <span class="ot">&lt;-</span> <span class="fu">glm</span>(mBanking <span class="sc">~</span> FAMSAT <span class="sc">+</span> FRISAT, </span>
<span id="cb56-877"><a href="#cb56-877" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb56-878"><a href="#cb56-878" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ds)</span>
<span id="cb56-879"><a href="#cb56-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-880"><a href="#cb56-880" aria-hidden="true" tabindex="-1"></a>model_rs <span class="ot">&lt;-</span> <span class="fu">glm</span>(mBanking <span class="sc">~</span> RS, </span>
<span id="cb56-881"><a href="#cb56-881" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb56-882"><a href="#cb56-882" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ds)   </span>
<span id="cb56-883"><a href="#cb56-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-884"><a href="#cb56-884" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_rs, model_famsatfrisat, <span class="at">test =</span> <span class="st">"Chisq"</span>)               </span>
<span id="cb56-885"><a href="#cb56-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-886"><a href="#cb56-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-887"><a href="#cb56-887" aria-hidden="true" tabindex="-1"></a>Since $p &gt; 0.05$, there is no significant difference in model performance. </span>
<span id="cb56-888"><a href="#cb56-888" aria-hidden="true" tabindex="-1"></a>It's better to keep one variable instead of two (simpler model is better).</span>
<span id="cb56-889"><a href="#cb56-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-890"><a href="#cb56-890" aria-hidden="true" tabindex="-1"></a>Continuing with our visualizations, let's see the changes to SD across MH scores. </span>
<span id="cb56-891"><a href="#cb56-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-892"><a href="#cb56-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_14}</span></span>
<span id="cb56-893"><a href="#cb56-893" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> ds, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> SD))<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span> </span>
<span id="cb56-894"><a href="#cb56-894" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb56-895"><a href="#cb56-895" aria-hidden="true" tabindex="-1"></a>              <span class="at">se     =</span> <span class="cn">FALSE</span>, </span>
<span id="cb56-896"><a href="#cb56-896" aria-hidden="true" tabindex="-1"></a>              <span class="at">col    =</span> <span class="st">"red"</span>,</span>
<span id="cb56-897"><a href="#cb56-897" aria-hidden="true" tabindex="-1"></a>              <span class="at">size   =</span> <span class="dv">2</span>, </span>
<span id="cb56-898"><a href="#cb56-898" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha  =</span> .<span class="dv">8</span>)<span class="sc">+</span> <span class="co"># to add regression line</span></span>
<span id="cb56-899"><a href="#cb56-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-900"><a href="#cb56-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-901"><a href="#cb56-901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-902"><a href="#cb56-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-903"><a href="#cb56-903" aria-hidden="true" tabindex="-1"></a>There's an almost negative linear relationship there: better mental health is associated with lower dependency on smartphones. </span>
<span id="cb56-904"><a href="#cb56-904" aria-hidden="true" tabindex="-1"></a>This intuitively makes sense. </span>
<span id="cb56-905"><a href="#cb56-905" aria-hidden="true" tabindex="-1"></a>Adding more nuance to this graph, I can see how this relationship changes for people who adopted m-banking and those that didn't. </span>
<span id="cb56-906"><a href="#cb56-906" aria-hidden="true" tabindex="-1"></a>It seems the two relationships are almost identical, at least in direction. </span>
<span id="cb56-907"><a href="#cb56-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-908"><a href="#cb56-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_16}</span></span>
<span id="cb56-909"><a href="#cb56-909" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data    =</span> ds,</span>
<span id="cb56-910"><a href="#cb56-910" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x   =</span> MH,</span>
<span id="cb56-911"><a href="#cb56-911" aria-hidden="true" tabindex="-1"></a>           <span class="at">y   =</span> SD,</span>
<span id="cb56-912"><a href="#cb56-912" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">as.factor</span>(mBanking)))<span class="sc">+</span> <span class="co">#to add the colours for different classes</span></span>
<span id="cb56-913"><a href="#cb56-913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size     =</span> <span class="fl">1.2</span>,</span>
<span id="cb56-914"><a href="#cb56-914" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha    =</span> .<span class="dv">8</span>,</span>
<span id="cb56-915"><a href="#cb56-915" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span> </span>
<span id="cb56-916"><a href="#cb56-916" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_color_manual(name = "MBanking",</span></span>
<span id="cb56-917"><a href="#cb56-917" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#labels = c("No", "Yes"),</span></span>
<span id="cb56-918"><a href="#cb56-918" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#values = c("red", "lightblue")) + #+ ggnewscale::new_scale_color() +</span></span>
<span id="cb56-919"><a href="#cb56-919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method   =</span> lm,</span>
<span id="cb56-920"><a href="#cb56-920" aria-hidden="true" tabindex="-1"></a>              <span class="at">se       =</span> T, </span>
<span id="cb56-921"><a href="#cb56-921" aria-hidden="true" tabindex="-1"></a>              <span class="at">size     =</span> <span class="fl">1.5</span>, </span>
<span id="cb56-922"><a href="#cb56-922" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb56-923"><a href="#cb56-923" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha    =</span> .<span class="dv">7</span>,</span>
<span id="cb56-924"><a href="#cb56-924" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span> </span>
<span id="cb56-925"><a href="#cb56-925" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"MBanking"</span>,</span>
<span id="cb56-926"><a href="#cb56-926" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb56-927"><a href="#cb56-927" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"darkred"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb56-928"><a href="#cb56-928" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-929"><a href="#cb56-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-930"><a href="#cb56-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-931"><a href="#cb56-931" aria-hidden="true" tabindex="-1"></a>The same type of visualizations can be helpful for other factors in the model.</span>
<span id="cb56-932"><a href="#cb56-932" aria-hidden="true" tabindex="-1"></a>Now, I will separate the data into those that have adopted m-banking and those that haven't. </span>
<span id="cb56-933"><a href="#cb56-933" aria-hidden="true" tabindex="-1"></a>Let's look at the differences in familial relationship satisfaction for these two groups across mental health. </span>
<span id="cb56-934"><a href="#cb56-934" aria-hidden="true" tabindex="-1"></a>For m-banking adopters, it seems that those with better mental health (3 or higher) are completely satisfied with their family relationships (blue bar). </span>
<span id="cb56-935"><a href="#cb56-935" aria-hidden="true" tabindex="-1"></a>On the other hand, those that haven't adopted m-banking are either less satisfied or completely unsatisfied (<span class="in">`MH = 5, mBanking = 0`</span> group's largest bar is red, which is <span class="in">`FAMSAT = 1`</span>, the lowest score).</span>
<span id="cb56-936"><a href="#cb56-936" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb56-937"><a href="#cb56-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_18, fig.width=15, fig.height=4}</span></span>
<span id="cb56-938"><a href="#cb56-938" aria-hidden="true" tabindex="-1"></a>ds1 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb56-939"><a href="#cb56-939" aria-hidden="true" tabindex="-1"></a>ds2 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb56-940"><a href="#cb56-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-941"><a href="#cb56-941" aria-hidden="true" tabindex="-1"></a>gg5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-942"><a href="#cb56-942" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-943"><a href="#cb56-943" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-944"><a href="#cb56-944" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-945"><a href="#cb56-945" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-946"><a href="#cb56-946" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"FAMSAT"</span>)</span>
<span id="cb56-947"><a href="#cb56-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-948"><a href="#cb56-948" aria-hidden="true" tabindex="-1"></a>gg6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-949"><a href="#cb56-949" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-950"><a href="#cb56-950" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(FAMSAT)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-951"><a href="#cb56-951" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-952"><a href="#cb56-952" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-953"><a href="#cb56-953" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"FAMSAT"</span>)</span>
<span id="cb56-954"><a href="#cb56-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-955"><a href="#cb56-955" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg5, gg6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span>
<span id="cb56-956"><a href="#cb56-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-957"><a href="#cb56-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-958"><a href="#cb56-958" aria-hidden="true" tabindex="-1"></a>It's important to mention that visualizations don't actually tell us the real story. </span>
<span id="cb56-959"><a href="#cb56-959" aria-hidden="true" tabindex="-1"></a>Especially when working with large datasets with more than 10,000 data points. </span>
<span id="cb56-960"><a href="#cb56-960" aria-hidden="true" tabindex="-1"></a>This is simply a somewhat visible pattern that tells me it's worth looking into when I do my statistical analysis. </span>
<span id="cb56-961"><a href="#cb56-961" aria-hidden="true" tabindex="-1"></a>We do the same type of visualization, now measuring social media use. </span>
<span id="cb56-962"><a href="#cb56-962" aria-hidden="true" tabindex="-1"></a>Surprisingly, social media use goes up with better mental health scores for adopters but decreases for non-adopters. </span>
<span id="cb56-963"><a href="#cb56-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-964"><a href="#cb56-964" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_19,fig.width=10, fig.height=4}</span></span>
<span id="cb56-965"><a href="#cb56-965" aria-hidden="true" tabindex="-1"></a>gg7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-966"><a href="#cb56-966" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-967"><a href="#cb56-967" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SNS)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-968"><a href="#cb56-968" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-969"><a href="#cb56-969" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-970"><a href="#cb56-970" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SNS"</span>)</span>
<span id="cb56-971"><a href="#cb56-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-972"><a href="#cb56-972" aria-hidden="true" tabindex="-1"></a>gg8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-973"><a href="#cb56-973" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-974"><a href="#cb56-974" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SNS)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-975"><a href="#cb56-975" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-976"><a href="#cb56-976" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-977"><a href="#cb56-977" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SNS"</span>)</span>
<span id="cb56-978"><a href="#cb56-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-979"><a href="#cb56-979" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg7, gg8, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span>
<span id="cb56-980"><a href="#cb56-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-981"><a href="#cb56-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-982"><a href="#cb56-982" aria-hidden="true" tabindex="-1"></a>Lastly, we do the same with smartphone dependency. </span>
<span id="cb56-983"><a href="#cb56-983" aria-hidden="true" tabindex="-1"></a>It seems that non-adopters are actually more dependent on their smartphones and also (with better mental health).</span>
<span id="cb56-984"><a href="#cb56-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-985"><a href="#cb56-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_20,fig.width=15, fig.height=4}</span></span>
<span id="cb56-986"><a href="#cb56-986" aria-hidden="true" tabindex="-1"></a>gg9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds1, <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-987"><a href="#cb56-987" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-988"><a href="#cb56-988" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SD)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-989"><a href="#cb56-989" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-990"><a href="#cb56-990" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-991"><a href="#cb56-991" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SD"</span>)</span>
<span id="cb56-992"><a href="#cb56-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-993"><a href="#cb56-993" aria-hidden="true" tabindex="-1"></a>gg10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mBanking <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> MH, <span class="at">y =</span> wtpg)) <span class="sc">+</span></span>
<span id="cb56-994"><a href="#cb56-994" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_col</span>(</span>
<span id="cb56-995"><a href="#cb56-995" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(SD)), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb56-996"><a href="#cb56-996" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fill_palette</span>(<span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb56-997"><a href="#cb56-997" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">"Mental Health"</span>) <span class="sc">+</span></span>
<span id="cb56-998"><a href="#cb56-998" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">"Weights"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"SD"</span>)</span>
<span id="cb56-999"><a href="#cb56-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1000"><a href="#cb56-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg9, gg10, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mBanking = 1"</span>, <span class="st">"mBanking = 0"</span>))</span>
<span id="cb56-1001"><a href="#cb56-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1002"><a href="#cb56-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1003"><a href="#cb56-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1004"><a href="#cb56-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modeling </span></span>
<span id="cb56-1005"><a href="#cb56-1005" aria-hidden="true" tabindex="-1"></a>I prepare the data for modeling by:</span>
<span id="cb56-1006"><a href="#cb56-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1007"><a href="#cb56-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculating mean-centered values for the numeric columns for easier interpretation since no value has a true zero.</span>
<span id="cb56-1008"><a href="#cb56-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>I convert some variables to factors, which are categorical variables with different levels and define various reference points for each for easier modeling practices </span>
<span id="cb56-1009"><a href="#cb56-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Note that if a variable's reference level is <span class="in">`l`</span>, then all the logistic regression coefficients for other levels are in comparison to level <span class="in">`l`</span></span>
<span id="cb56-1010"><a href="#cb56-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1011"><a href="#cb56-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_21}</span></span>
<span id="cb56-1012"><a href="#cb56-1012" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-1013"><a href="#cb56-1013" aria-hidden="true" tabindex="-1"></a>    <span class="at">MH_c =</span> MH <span class="sc">-</span> <span class="fu">mean</span>(MH), </span>
<span id="cb56-1014"><a href="#cb56-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_c =</span> SD <span class="sc">-</span> <span class="fu">mean</span>(SD),</span>
<span id="cb56-1015"><a href="#cb56-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">SNS_f =</span> <span class="fu">as.factor</span>(SNS),</span>
<span id="cb56-1016"><a href="#cb56-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">RS_c =</span> RS <span class="sc">-</span> <span class="fu">mean</span>(RS),</span>
<span id="cb56-1017"><a href="#cb56-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_c =</span> AGE <span class="sc">-</span> <span class="fu">mean</span>(AGE),</span>
<span id="cb56-1018"><a href="#cb56-1018" aria-hidden="true" tabindex="-1"></a>    <span class="at">SEX_f =</span> <span class="fu">as.factor</span>(SEX),</span>
<span id="cb56-1019"><a href="#cb56-1019" aria-hidden="true" tabindex="-1"></a>    <span class="at">EMP_f =</span> <span class="fu">as.factor</span>(EMP),</span>
<span id="cb56-1020"><a href="#cb56-1020" aria-hidden="true" tabindex="-1"></a>    <span class="at">EDU_c =</span> EDU <span class="sc">-</span> <span class="fu">mean</span>(EDU),</span>
<span id="cb56-1021"><a href="#cb56-1021" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAM_f =</span> <span class="fu">as.factor</span>(FAM),</span>
<span id="cb56-1022"><a href="#cb56-1022" aria-hidden="true" tabindex="-1"></a>    <span class="at">INC_c =</span> INC <span class="sc">-</span> <span class="fu">mean</span>(INC),</span>
<span id="cb56-1023"><a href="#cb56-1023" aria-hidden="true" tabindex="-1"></a>    <span class="at">IMM_f =</span> <span class="fu">as.factor</span>(IMM),</span>
<span id="cb56-1024"><a href="#cb56-1024" aria-hidden="true" tabindex="-1"></a>    <span class="at">PRVNC =</span> <span class="fu">as.factor</span>(province)</span>
<span id="cb56-1025"><a href="#cb56-1025" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1026"><a href="#cb56-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1027"><a href="#cb56-1027" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb56-1028"><a href="#cb56-1028" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb56-1029"><a href="#cb56-1029" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SEX </span></span>
<span id="cb56-1030"><a href="#cb56-1030" aria-hidden="true" tabindex="-1"></a>        <span class="at">SEX_factor_Fem =</span> <span class="fu">relevel</span>(SEX_f, <span class="at">ref =</span> <span class="st">'2'</span>),</span>
<span id="cb56-1031"><a href="#cb56-1031" aria-hidden="true" tabindex="-1"></a>        <span class="at">SEX_factor_Mal =</span> <span class="fu">relevel</span>(SEX_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb56-1032"><a href="#cb56-1032" aria-hidden="true" tabindex="-1"></a>        <span class="co"># EMP</span></span>
<span id="cb56-1033"><a href="#cb56-1033" aria-hidden="true" tabindex="-1"></a>        <span class="at">EMP_factor_not =</span> <span class="fu">relevel</span>(EMP_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb56-1034"><a href="#cb56-1034" aria-hidden="true" tabindex="-1"></a>        <span class="at">EMP_factor_Emp =</span> <span class="fu">relevel</span>(EMP_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb56-1035"><a href="#cb56-1035" aria-hidden="true" tabindex="-1"></a>        <span class="co"># FAM </span></span>
<span id="cb56-1036"><a href="#cb56-1036" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_1 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb56-1037"><a href="#cb56-1037" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_2 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'2'</span>),</span>
<span id="cb56-1038"><a href="#cb56-1038" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_3 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'3'</span>),</span>
<span id="cb56-1039"><a href="#cb56-1039" aria-hidden="true" tabindex="-1"></a>        <span class="at">FAM_factor_4 =</span> <span class="fu">relevel</span>(FAM_f, <span class="at">ref =</span> <span class="st">'4'</span>),</span>
<span id="cb56-1040"><a href="#cb56-1040" aria-hidden="true" tabindex="-1"></a>        <span class="co"># IMM</span></span>
<span id="cb56-1041"><a href="#cb56-1041" aria-hidden="true" tabindex="-1"></a>        <span class="at">IMM_factor_Imm =</span> <span class="fu">relevel</span>(IMM_f, <span class="at">ref =</span> <span class="st">'1'</span>),</span>
<span id="cb56-1042"><a href="#cb56-1042" aria-hidden="true" tabindex="-1"></a>        <span class="at">IMM_factor_non =</span> <span class="fu">relevel</span>(IMM_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb56-1043"><a href="#cb56-1043" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SNS </span></span>
<span id="cb56-1044"><a href="#cb56-1044" aria-hidden="true" tabindex="-1"></a>        <span class="at">SNS_factor_notuse =</span> <span class="fu">relevel</span>(SNS_f, <span class="at">ref =</span> <span class="st">'0'</span>),</span>
<span id="cb56-1045"><a href="#cb56-1045" aria-hidden="true" tabindex="-1"></a>        <span class="at">SNS_factor_use =</span> <span class="fu">relevel</span>(SNS_f, <span class="at">ref =</span> <span class="st">'1'</span>)</span>
<span id="cb56-1046"><a href="#cb56-1046" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1047"><a href="#cb56-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1048"><a href="#cb56-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1049"><a href="#cb56-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1050"><a href="#cb56-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1051"><a href="#cb56-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Considering Sampling Clusters</span></span>
<span id="cb56-1052"><a href="#cb56-1052" aria-hidden="true" tabindex="-1"></a>This dataset was sampled by clustering on provinces. </span>
<span id="cb56-1053"><a href="#cb56-1053" aria-hidden="true" tabindex="-1"></a>CIUS does not disclose their sample measure in full detail, but it is best practice to consider this sampling design in the model.</span>
<span id="cb56-1054"><a href="#cb56-1054" aria-hidden="true" tabindex="-1"></a>There are multiple ways to do it: </span>
<span id="cb56-1055"><a href="#cb56-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1056"><a href="#cb56-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Apply the weights to the model in <span class="in">`glm()`</span>; since the dataset is quite large, adding the weights will render everything statistically significant and therefore is not useful for our purposes </span>
<span id="cb56-1057"><a href="#cb56-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Use a survey-specific module like the <span class="in">`survey`</span> package developed by <span class="co">[</span><span class="ot">Thomas Lumley</span><span class="co">](https://www.rdocumentation.org/packages/survey/versions/4.4-2)</span> to account for survey methods, stratification, framing, sampling strategy and weights. </span>
<span id="cb56-1058"><a href="#cb56-1058" aria-hidden="true" tabindex="-1"></a>The way you'd do this is: </span>
<span id="cb56-1059"><a href="#cb56-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1060"><a href="#cb56-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_surveyEx}</span></span>
<span id="cb56-1061"><a href="#cb56-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb56-1062"><a href="#cb56-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1063"><a href="#cb56-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb56-1064"><a href="#cb56-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1065"><a href="#cb56-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># define survey design </span></span>
<span id="cb56-1066"><a href="#cb56-1066" aria-hidden="true" tabindex="-1"></a>ds_svy <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>province, <span class="at">weights =</span> <span class="sc">~</span>wtpg, <span class="at">data =</span> ds)</span>
<span id="cb56-1067"><a href="#cb56-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1068"><a href="#cb56-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># run survey glm : svyglm()</span></span>
<span id="cb56-1069"><a href="#cb56-1069" aria-hidden="true" tabindex="-1"></a>model1_svy <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb56-1070"><a href="#cb56-1070" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> ..., </span>
<span id="cb56-1071"><a href="#cb56-1071" aria-hidden="true" tabindex="-1"></a>    <span class="at">family=</span>stats<span class="sc">::</span><span class="fu">gaussian</span>(),</span>
<span id="cb56-1072"><a href="#cb56-1072" aria-hidden="true" tabindex="-1"></a>    <span class="at">start=</span><span class="cn">NULL</span>, <span class="at">rescale=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">FALSE</span>,<span class="at">influence=</span><span class="cn">FALSE</span>)</span>
<span id="cb56-1073"><a href="#cb56-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1074"><a href="#cb56-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1_svy, <span class="at">correlation =</span> <span class="cn">FALSE</span>, <span class="at">df.resid=</span><span class="cn">NULL</span>)</span>
<span id="cb56-1075"><a href="#cb56-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1076"><a href="#cb56-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1077"><a href="#cb56-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1078"><a href="#cb56-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Another method is to consider robust standard errors </span>
<span id="cb56-1079"><a href="#cb56-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Lastly, the method I've decided on is to consider this clustering in the model as a group using mixed-effect models </span>
<span id="cb56-1080"><a href="#cb56-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1081"><a href="#cb56-1081" aria-hidden="true" tabindex="-1"></a>Let's visualize the distribution of m-banking adoption across provinces for all <span class="in">`MH`</span> scores: </span>
<span id="cb56-1082"><a href="#cb56-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1083"><a href="#cb56-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_22}</span></span>
<span id="cb56-1084"><a href="#cb56-1084" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb56-1085"><a href="#cb56-1085" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb56-1086"><a href="#cb56-1086" aria-hidden="true" tabindex="-1"></a>        <span class="at">province_f_coded =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb56-1087"><a href="#cb56-1087" aria-hidden="true" tabindex="-1"></a>            PRVNC,</span>
<span id="cb56-1088"><a href="#cb56-1088" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NL'</span> <span class="ot">=</span> <span class="st">'10'</span>,</span>
<span id="cb56-1089"><a href="#cb56-1089" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NS'</span> <span class="ot">=</span> <span class="st">'12'</span>, </span>
<span id="cb56-1090"><a href="#cb56-1090" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NB'</span> <span class="ot">=</span> <span class="st">'13'</span>,</span>
<span id="cb56-1091"><a href="#cb56-1091" aria-hidden="true" tabindex="-1"></a>            <span class="st">'QC'</span> <span class="ot">=</span> <span class="st">'24'</span>,</span>
<span id="cb56-1092"><a href="#cb56-1092" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ON'</span> <span class="ot">=</span> <span class="st">'35'</span>, </span>
<span id="cb56-1093"><a href="#cb56-1093" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MB'</span> <span class="ot">=</span> <span class="st">'46'</span>, </span>
<span id="cb56-1094"><a href="#cb56-1094" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SK'</span> <span class="ot">=</span> <span class="st">'47'</span>, </span>
<span id="cb56-1095"><a href="#cb56-1095" aria-hidden="true" tabindex="-1"></a>            <span class="st">'AB'</span> <span class="ot">=</span> <span class="st">'48'</span>, </span>
<span id="cb56-1096"><a href="#cb56-1096" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BC'</span> <span class="ot">=</span> <span class="st">'59'</span></span>
<span id="cb56-1097"><a href="#cb56-1097" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb56-1098"><a href="#cb56-1098" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1099"><a href="#cb56-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1100"><a href="#cb56-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1101"><a href="#cb56-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_23}</span></span>
<span id="cb56-1102"><a href="#cb56-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds, <span class="fu">aes</span>(province_f_coded, mBanking, <span class="at">color =</span> <span class="fu">as.factor</span>(MH))) <span class="sc">+</span></span>
<span id="cb56-1103"><a href="#cb56-1103" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb56-1104"><a href="#cb56-1104" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb56-1105"><a href="#cb56-1105" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb56-1106"><a href="#cb56-1106" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb56-1107"><a href="#cb56-1107" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Province"</span>, <span class="at">y =</span> <span class="st">"Observed Probabilty of mobile banking"</span>, <span class="at">color =</span> <span class="st">"MH"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb56-1108"><a href="#cb56-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1109"><a href="#cb56-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1110"><a href="#cb56-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1111"><a href="#cb56-1111" aria-hidden="true" tabindex="-1"></a>There is clearly some variation in the probabilities of m-banking and the effects of <span class="in">`MH`</span> on this across the provinces. </span>
<span id="cb56-1112"><a href="#cb56-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1113"><a href="#cb56-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mathematical Modeling </span></span>
<span id="cb56-1114"><a href="#cb56-1114" aria-hidden="true" tabindex="-1"></a>Following the paper, I have these models (I'm skipping over the choise of <span class="in">`RS`</span> instead of <span class="in">`FAMSAT + FRISAT`</span> as it was discussed above): </span>
<span id="cb56-1115"><a href="#cb56-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1116"><a href="#cb56-1116" aria-hidden="true" tabindex="-1"></a>**Model 1. Standard Logistic Regression**</span>
<span id="cb56-1117"><a href="#cb56-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1118"><a href="#cb56-1118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1119"><a href="#cb56-1119" aria-hidden="true" tabindex="-1"></a>\begin{equation*}</span>
<span id="cb56-1120"><a href="#cb56-1120" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb56-1121"><a href="#cb56-1121" aria-hidden="true" tabindex="-1"></a>  &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = <span class="sc">\\</span></span>
<span id="cb56-1122"><a href="#cb56-1122" aria-hidden="true" tabindex="-1"></a>  &amp; \ \beta_0 + \beta_{1} \ MH + \ \beta_2 \ SD + \ \beta_3 \ D_{SNS_0} + \ \beta_4 \ AGE \ + \ \beta_5 \ D_{SEX_m} <span class="sc">\\</span></span>
<span id="cb56-1123"><a href="#cb56-1123" aria-hidden="true" tabindex="-1"></a>  &amp;  + \ \beta_6 \ D_{EMP_0} \ + \ \beta_7 \ EDU + \ \beta_8 \ INC \ + \ \beta_9 \ D_{FAM_1} + \ \beta_{10} \ D_{FAM_3}<span class="sc">\\</span></span>
<span id="cb56-1124"><a href="#cb56-1124" aria-hidden="true" tabindex="-1"></a>  &amp; + \ \beta_{11} \ D_{FAM_4} \ + \ \beta_{12} \ D_{IMM_1} + \ \beta_{13} \ RS + \ \epsilon <span class="sc">\\</span></span>
<span id="cb56-1125"><a href="#cb56-1125" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb56-1126"><a href="#cb56-1126" aria-hidden="true" tabindex="-1"></a>\end{equation*}</span>
<span id="cb56-1127"><a href="#cb56-1127" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1128"><a href="#cb56-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1129"><a href="#cb56-1129" aria-hidden="true" tabindex="-1"></a>Where $D$ is a dummy variable representing the case that the value of the variable in the index is some specific level. </span>
<span id="cb56-1130"><a href="#cb56-1130" aria-hidden="true" tabindex="-1"></a>For example, $D_{SNS_0}$ gets a $1$ in every cell where <span class="in">`SNS = 0`</span>. </span>
<span id="cb56-1131"><a href="#cb56-1131" aria-hidden="true" tabindex="-1"></a>This is modeled in R: </span>
<span id="cb56-1132"><a href="#cb56-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1133"><a href="#cb56-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_26}</span></span>
<span id="cb56-1134"><a href="#cb56-1134" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb56-1135"><a href="#cb56-1135" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c,</span>
<span id="cb56-1136"><a href="#cb56-1136" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb56-1137"><a href="#cb56-1137" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb56-1138"><a href="#cb56-1138" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1139"><a href="#cb56-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1140"><a href="#cb56-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1141"><a href="#cb56-1141" aria-hidden="true" tabindex="-1"></a>**Model 2. Fixed Effect Logistic Regression**</span>
<span id="cb56-1142"><a href="#cb56-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1143"><a href="#cb56-1143" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1144"><a href="#cb56-1144" aria-hidden="true" tabindex="-1"></a>\begin{equation*}</span>
<span id="cb56-1145"><a href="#cb56-1145" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb56-1146"><a href="#cb56-1146" aria-hidden="true" tabindex="-1"></a>  &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = <span class="sc">\\</span></span>
<span id="cb56-1147"><a href="#cb56-1147" aria-hidden="true" tabindex="-1"></a>  &amp; \ \gamma_{0,j} + u_{0,j} + \beta_{1} \ MH + \ \beta_2 \ SD + \ \beta_3 \ D_{SNS_0} + \ \beta_4 \ AGE \ + \ \beta_5 \ D_{SEX_m}<span class="sc">\\</span></span>
<span id="cb56-1148"><a href="#cb56-1148" aria-hidden="true" tabindex="-1"></a>  &amp;  + \ \beta_6 \ D_{EMP_0} \ + \ \beta_7 \ EDU + \ \beta_8 \ INC \ + \ \beta_9 \ D_{FAM_1} + \ \beta_{10} \ D_{FAM_3}<span class="sc">\\</span></span>
<span id="cb56-1149"><a href="#cb56-1149" aria-hidden="true" tabindex="-1"></a>  &amp; + \ \beta_{11} \ D_{FAM_4} \ + \ \beta_{12} \ D_{IMM_1} + \ \beta_{13} \ RS + \ \epsilon <span class="sc">\\</span></span>
<span id="cb56-1150"><a href="#cb56-1150" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb56-1151"><a href="#cb56-1151" aria-hidden="true" tabindex="-1"></a>\end{equation*}</span>
<span id="cb56-1152"><a href="#cb56-1152" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1153"><a href="#cb56-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1154"><a href="#cb56-1154" aria-hidden="true" tabindex="-1"></a>This is where <span class="in">`province`</span> only affects the intercept (m-banking). </span>
<span id="cb56-1155"><a href="#cb56-1155" aria-hidden="true" tabindex="-1"></a>I used the <span class="in">`glmer`</span> function from the <span class="in">`lme4`</span> package. </span>
<span id="cb56-1156"><a href="#cb56-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1157"><a href="#cb56-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_27}</span></span>
<span id="cb56-1158"><a href="#cb56-1158" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb56-1159"><a href="#cb56-1159" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> province),</span>
<span id="cb56-1160"><a href="#cb56-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb56-1161"><a href="#cb56-1161" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb56-1162"><a href="#cb56-1162" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>)</span>
<span id="cb56-1163"><a href="#cb56-1163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1164"><a href="#cb56-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1165"><a href="#cb56-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1166"><a href="#cb56-1166" aria-hidden="true" tabindex="-1"></a>**Model 3. Random Effect Logistic Regression**</span>
<span id="cb56-1167"><a href="#cb56-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1168"><a href="#cb56-1168" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1169"><a href="#cb56-1169" aria-hidden="true" tabindex="-1"></a>\begin{equation*}</span>
<span id="cb56-1170"><a href="#cb56-1170" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb56-1171"><a href="#cb56-1171" aria-hidden="true" tabindex="-1"></a>   &amp; \ln\frac{P(Y = 1)}{1 - P(Y = 1)} = <span class="sc">\\</span></span>
<span id="cb56-1172"><a href="#cb56-1172" aria-hidden="true" tabindex="-1"></a>   &amp; \ \gamma_{0,0} + u_{0,j} + (\gamma_{1,0} + u_{1,j}) \ MH + \ (\gamma_{2,0} + u_{2,j}) \ SD \ + \ (\gamma_{3,0} + u_{3,j}) \ SNS <span class="sc">\\</span></span>
<span id="cb56-1173"><a href="#cb56-1173" aria-hidden="true" tabindex="-1"></a>   &amp; + \ (\gamma_{4,0} + u_{4,j}) \ AGE \ + \ (\gamma_{5,0} + u_{5,j}) \ SEX \ + \ (\gamma_{6,0} + u_{6,j}) EMP <span class="sc">\\</span></span>
<span id="cb56-1174"><a href="#cb56-1174" aria-hidden="true" tabindex="-1"></a>   &amp; + \ (\gamma_{7,0} + u_{7,j}) \ EDU \ + \ (\gamma_{8,0} + u_{8,j}) \ INC \</span>
<span id="cb56-1175"><a href="#cb56-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>\ (\gamma_{9,0} + u_{9,j}) \ D_{FAM_1} <span class="sc">\\</span></span>
<span id="cb56-1176"><a href="#cb56-1176" aria-hidden="true" tabindex="-1"></a>   &amp; + \ (\gamma_{10,0} + u_{10,j}) \ D_{FAM_3} \ + \ (\gamma_{11,0} + u_{11,j}) \ D_{FAM_4} <span class="sc">\\</span> </span>
<span id="cb56-1177"><a href="#cb56-1177" aria-hidden="true" tabindex="-1"></a>   &amp; + \ (\gamma_{12,0} + u_{12,j}) \ IMM_1 \ + \ (\gamma_{13,0} + u_{13,j}) \ RS + \ \epsilon <span class="sc">\\</span></span>
<span id="cb56-1178"><a href="#cb56-1178" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb56-1179"><a href="#cb56-1179" aria-hidden="true" tabindex="-1"></a>\end{equation*}</span>
<span id="cb56-1180"><a href="#cb56-1180" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1181"><a href="#cb56-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1182"><a href="#cb56-1182" aria-hidden="true" tabindex="-1"></a>This is where <span class="in">`province`</span> only affects everything. </span>
<span id="cb56-1183"><a href="#cb56-1183" aria-hidden="true" tabindex="-1"></a>This model may not converge (it does in this case, but it takes about 30 minutes with no other processes running on a Macbook Air M2). </span>
<span id="cb56-1184"><a href="#cb56-1184" aria-hidden="true" tabindex="-1"></a>An easier model that considers random effects may be to just include the random effect on the primary variable <span class="in">`MH`</span> and its related constructs (<span class="in">`model4`</span>). </span>
<span id="cb56-1185"><a href="#cb56-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1186"><a href="#cb56-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1187"><a href="#cb56-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_28}</span></span>
<span id="cb56-1188"><a href="#cb56-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb56-1189"><a href="#cb56-1189" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb56-1190"><a href="#cb56-1190" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> </span>
<span id="cb56-1191"><a href="#cb56-1191" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_f <span class="sc">+</span> EMP <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_2 <span class="sc">+</span> IMM_n <span class="sc">+</span> </span>
<span id="cb56-1192"><a href="#cb56-1192" aria-hidden="true" tabindex="-1"></a>    INC_c <span class="sc">|</span> province),</span>
<span id="cb56-1193"><a href="#cb56-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb56-1194"><a href="#cb56-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb56-1195"><a href="#cb56-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb56-1196"><a href="#cb56-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1197"><a href="#cb56-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1198"><a href="#cb56-1198" aria-hidden="true" tabindex="-1"></a>For faster speeds, I'll test everything with this model (random):</span>
<span id="cb56-1199"><a href="#cb56-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_29} </span></span>
<span id="cb56-1200"><a href="#cb56-1200" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb56-1201"><a href="#cb56-1201" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c <span class="sc">+</span> </span>
<span id="cb56-1202"><a href="#cb56-1202" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">|</span> province),</span>
<span id="cb56-1203"><a href="#cb56-1203" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb56-1204"><a href="#cb56-1204" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb56-1205"><a href="#cb56-1205" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb56-1206"><a href="#cb56-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1207"><a href="#cb56-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1208"><a href="#cb56-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing models </span></span>
<span id="cb56-1209"><a href="#cb56-1209" aria-hidden="true" tabindex="-1"></a>Since <span class="in">`model3`</span> doesn't run fast and I am using <span class="in">`Quarto`</span> for rendering the code blocks, I decided to use <span class="in">`model4`</span> for comparisons. </span>
<span id="cb56-1210"><a href="#cb56-1210" aria-hidden="true" tabindex="-1"></a>The values here will be different from the paper, but the ideas are the same. </span>
<span id="cb56-1211"><a href="#cb56-1211" aria-hidden="true" tabindex="-1"></a>To pick the best model I do: </span>
<span id="cb56-1212"><a href="#cb56-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1213"><a href="#cb56-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Likelihood Ratio Test to pick between <span class="in">`model1`</span> vs <span class="in">`model2`</span> - the null hypothesis is that there is no significant difference between the models (if you reject this, then you should go with the model that captures more information)</span>
<span id="cb56-1214"><a href="#cb56-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>If you reject $H_0$ of LR test, i.e., <span class="in">`model2`</span> wins $\implies$ we compare it to <span class="in">`model4`</span> and we need the Hausman test </span>
<span id="cb56-1215"><a href="#cb56-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Unfortunately, the Hausman test requires the <span class="in">`plm`</span> package and panel data. To avoid messing the data up again, I coded the calculations manually based on the Hausman formula. This is referenced in the paper. </span>
<span id="cb56-1216"><a href="#cb56-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>If you can't reject $H_0$ of LR test, i.e., <span class="in">`model1`</span> wins, we should just use that as it's simpler </span>
<span id="cb56-1217"><a href="#cb56-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1218"><a href="#cb56-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_30}</span></span>
<span id="cb56-1219"><a href="#cb56-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(model1, model2)</span>
<span id="cb56-1220"><a href="#cb56-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1221"><a href="#cb56-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1222"><a href="#cb56-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1223"><a href="#cb56-1223" aria-hidden="true" tabindex="-1"></a>Since <span class="in">`model2`</span> won, we now compare it with <span class="in">`model4`</span>. </span>
<span id="cb56-1224"><a href="#cb56-1224" aria-hidden="true" tabindex="-1"></a>Hausman test for fixed effects in R is a bit tricky, so, I did it manually following the formula:</span>
<span id="cb56-1225"><a href="#cb56-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1226"><a href="#cb56-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Extract per-group (province) coefficients for both models and convert them to data frames </span>
<span id="cb56-1227"><a href="#cb56-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_31}</span></span>
<span id="cb56-1228"><a href="#cb56-1228" aria-hidden="true" tabindex="-1"></a>coefs_fixed <span class="ot">&lt;-</span> <span class="fu">coef</span>(model2)</span>
<span id="cb56-1229"><a href="#cb56-1229" aria-hidden="true" tabindex="-1"></a>coefs_rando <span class="ot">&lt;-</span> <span class="fu">coef</span>(model4)</span>
<span id="cb56-1230"><a href="#cb56-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1231"><a href="#cb56-1231" aria-hidden="true" tabindex="-1"></a>coefs_fixed_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coefs_fixed<span class="sc">$</span>province)</span>
<span id="cb56-1232"><a href="#cb56-1232" aria-hidden="true" tabindex="-1"></a>coefs_rando_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coefs_rando<span class="sc">$</span>province)</span>
<span id="cb56-1233"><a href="#cb56-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1234"><a href="#cb56-1234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1235"><a href="#cb56-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1236"><a href="#cb56-1236" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Subtract Random Effects model coefficients from Fixed Effect model, per province. This gives you the core term of the Hausman test: </span>
<span id="cb56-1237"><a href="#cb56-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_32}</span></span>
<span id="cb56-1238"><a href="#cb56-1238" aria-hidden="true" tabindex="-1"></a>coefs_diff <span class="ot">&lt;-</span> coefs_fixed_df <span class="sc">-</span> coefs_rando_df</span>
<span id="cb56-1239"><a href="#cb56-1239" aria-hidden="true" tabindex="-1"></a>coef_diffs_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coefs_diff)</span>
<span id="cb56-1240"><a href="#cb56-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1241"><a href="#cb56-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1242"><a href="#cb56-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1243"><a href="#cb56-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Estimate the difference in the variance-covariance matrices of the coefficient estimates. </span>
<span id="cb56-1244"><a href="#cb56-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_33}</span></span>
<span id="cb56-1245"><a href="#cb56-1245" aria-hidden="true" tabindex="-1"></a>V_diff <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vcov</span>(model2) <span class="sc">-</span> <span class="fu">vcov</span>(model4))</span>
<span id="cb56-1246"><a href="#cb56-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1247"><a href="#cb56-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1248"><a href="#cb56-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1249"><a href="#cb56-1249" aria-hidden="true" tabindex="-1"></a>What I need is:  </span>
<span id="cb56-1250"><a href="#cb56-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1251"><a href="#cb56-1251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1252"><a href="#cb56-1252" aria-hidden="true" tabindex="-1"></a>H = (\hat{\beta_{F}} - \hat{\beta_{R}}) \cdot V^{-1} \cdot (\hat{\beta_{F}} - \hat{\beta_{R}})^T</span>
<span id="cb56-1253"><a href="#cb56-1253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb56-1254"><a href="#cb56-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1255"><a href="#cb56-1255" aria-hidden="true" tabindex="-1"></a>Just checking that the matrix multiplications make sense: </span>
<span id="cb56-1256"><a href="#cb56-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_34}</span></span>
<span id="cb56-1257"><a href="#cb56-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">t</span>(coef_diffs_matrix))</span>
<span id="cb56-1258"><a href="#cb56-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">solve</span>(V_diff))</span>
<span id="cb56-1259"><a href="#cb56-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(coef_diffs_matrix)</span>
<span id="cb56-1260"><a href="#cb56-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1261"><a href="#cb56-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1262"><a href="#cb56-1262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1263"><a href="#cb56-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1264"><a href="#cb56-1264" aria-hidden="true" tabindex="-1"></a>They do! So, calculate $H$:</span>
<span id="cb56-1265"><a href="#cb56-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1266"><a href="#cb56-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_35}</span></span>
<span id="cb56-1267"><a href="#cb56-1267" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> coef_diffs_matrix <span class="sc">%*%</span> <span class="fu">solve</span>(V_diff) <span class="sc">%*%</span> <span class="fu">t</span>(coef_diffs_matrix)</span>
<span id="cb56-1268"><a href="#cb56-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1269"><a href="#cb56-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1270"><a href="#cb56-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1271"><a href="#cb56-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1272"><a href="#cb56-1272" aria-hidden="true" tabindex="-1"></a>This is the actual critical $\chi^2$ value at degrees of freedom 13 (for 14 covariates), in fact, I can check: </span>
<span id="cb56-1273"><a href="#cb56-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1274"><a href="#cb56-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_36}</span></span>
<span id="cb56-1275"><a href="#cb56-1275" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(V_diff)<span class="sc">$</span>rank</span>
<span id="cb56-1276"><a href="#cb56-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1277"><a href="#cb56-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1278"><a href="#cb56-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1279"><a href="#cb56-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_37}</span></span>
<span id="cb56-1280"><a href="#cb56-1280" aria-hidden="true" tabindex="-1"></a>chisq_critical <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> <span class="dv">13</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-1281"><a href="#cb56-1281" aria-hidden="true" tabindex="-1"></a>chisq_critical</span>
<span id="cb56-1282"><a href="#cb56-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1283"><a href="#cb56-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1284"><a href="#cb56-1284" aria-hidden="true" tabindex="-1"></a>If $H1 &gt; \chi^2$ then reject the null hypothesis that says the fixed model is better.</span>
<span id="cb56-1285"><a href="#cb56-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_38}</span></span>
<span id="cb56-1286"><a href="#cb56-1286" aria-hidden="true" tabindex="-1"></a>H <span class="sc">&gt;</span> chisq_critical <span class="co">#reject H0: the fixed model is better.  </span></span>
<span id="cb56-1287"><a href="#cb56-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1288"><a href="#cb56-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1289"><a href="#cb56-1289" aria-hidden="true" tabindex="-1"></a>The p-value: </span>
<span id="cb56-1290"><a href="#cb56-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_39}</span></span>
<span id="cb56-1291"><a href="#cb56-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(H, <span class="at">df =</span> <span class="dv">13</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-1292"><a href="#cb56-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1293"><a href="#cb56-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1294"><a href="#cb56-1294" aria-hidden="true" tabindex="-1"></a>Ok, we can't reject this hypothesis - therefore, the fixed model is better. </span>
<span id="cb56-1295"><a href="#cb56-1295" aria-hidden="true" tabindex="-1"></a>Another way to check:</span>
<span id="cb56-1296"><a href="#cb56-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1297"><a href="#cb56-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_40}</span></span>
<span id="cb56-1298"><a href="#cb56-1298" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2, model4)</span>
<span id="cb56-1299"><a href="#cb56-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1300"><a href="#cb56-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1301"><a href="#cb56-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1302"><a href="#cb56-1302" aria-hidden="true" tabindex="-1"></a>The models are basically the same - which means, go with the simpler one! </span>
<span id="cb56-1303"><a href="#cb56-1303" aria-hidden="true" tabindex="-1"></a>So, best model is <span class="in">`model2`</span>. </span>
<span id="cb56-1304"><a href="#cb56-1304" aria-hidden="true" tabindex="-1"></a>Now adding interaction terms to test the hypotheses of study 2, which are: </span>
<span id="cb56-1305"><a href="#cb56-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1306"><a href="#cb56-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mental Health significantly affects mobile banking adoption.</span>
<span id="cb56-1307"><a href="#cb56-1307" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Relationship Satisfaction moderates the effect of Mental Health on adoption.</span>
<span id="cb56-1308"><a href="#cb56-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Smartphone Dependency moderates the effect of Mental Health on adoption.</span>
<span id="cb56-1309"><a href="#cb56-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Social Media use moderates the effect of Mental Health on adoption.</span>
<span id="cb56-1310"><a href="#cb56-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1311"><a href="#cb56-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1312"><a href="#cb56-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_41}</span></span>
<span id="cb56-1313"><a href="#cb56-1313" aria-hidden="true" tabindex="-1"></a>model2_int <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb56-1314"><a href="#cb56-1314" aria-hidden="true" tabindex="-1"></a>    mBanking <span class="sc">~</span> MH_c <span class="sc">+</span> SD_c <span class="sc">+</span> SNS_factor_use <span class="sc">+</span> RS_c <span class="sc">+</span> AGE_c <span class="sc">+</span> SEX_factor_Fem </span>
<span id="cb56-1315"><a href="#cb56-1315" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> EMP_factor_Emp <span class="sc">+</span> EDU_c <span class="sc">+</span> FAM_factor_2 <span class="sc">+</span> IMM_factor_non <span class="sc">+</span> INC_c </span>
<span id="cb56-1316"><a href="#cb56-1316" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> MH_c<span class="sc">:</span>RS_c <span class="sc">+</span> MH_c<span class="sc">:</span>SD_c <span class="sc">+</span> MH_c<span class="sc">:</span>SNS_factor_use </span>
<span id="cb56-1317"><a href="#cb56-1317" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> province),</span>
<span id="cb56-1318"><a href="#cb56-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ds,</span>
<span id="cb56-1319"><a href="#cb56-1319" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb56-1320"><a href="#cb56-1320" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb56-1321"><a href="#cb56-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1322"><a href="#cb56-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1323"><a href="#cb56-1323" aria-hidden="true" tabindex="-1"></a>Printing both odds ratios and log-odds versions using two different summary functions: </span>
<span id="cb56-1324"><a href="#cb56-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1325"><a href="#cb56-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_42}</span></span>
<span id="cb56-1326"><a href="#cb56-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(</span>
<span id="cb56-1327"><a href="#cb56-1327" aria-hidden="true" tabindex="-1"></a>    model2,</span>
<span id="cb56-1328"><a href="#cb56-1328" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> F,</span>
<span id="cb56-1329"><a href="#cb56-1329" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvals =</span> T,</span>
<span id="cb56-1330"><a href="#cb56-1330" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp =</span> T, </span>
<span id="cb56-1331"><a href="#cb56-1331" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb56-1332"><a href="#cb56-1332" aria-hidden="true" tabindex="-1"></a>    <span class="co">#part.corr = T, #Print partial (labeled "partial.r") and semipartial (labeled "part.r")</span></span>
<span id="cb56-1333"><a href="#cb56-1333" aria-hidden="true" tabindex="-1"></a>    <span class="co">#confint = getOption("summ-confint", FALSE),</span></span>
<span id="cb56-1334"><a href="#cb56-1334" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ci.width = getOption("summ-ci.width", 0.95),</span></span>
<span id="cb56-1335"><a href="#cb56-1335" aria-hidden="true" tabindex="-1"></a>    <span class="co">#vifs = T</span></span>
<span id="cb56-1336"><a href="#cb56-1336" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1337"><a href="#cb56-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1338"><a href="#cb56-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1339"><a href="#cb56-1339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_43}</span></span>
<span id="cb56-1340"><a href="#cb56-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span>
<span id="cb56-1341"><a href="#cb56-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1342"><a href="#cb56-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1343"><a href="#cb56-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_44}</span></span>
<span id="cb56-1344"><a href="#cb56-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(</span>
<span id="cb56-1345"><a href="#cb56-1345" aria-hidden="true" tabindex="-1"></a>    model2_int,</span>
<span id="cb56-1346"><a href="#cb56-1346" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> F,</span>
<span id="cb56-1347"><a href="#cb56-1347" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvals =</span> T,</span>
<span id="cb56-1348"><a href="#cb56-1348" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp =</span> T, </span>
<span id="cb56-1349"><a href="#cb56-1349" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb56-1350"><a href="#cb56-1350" aria-hidden="true" tabindex="-1"></a>    <span class="co">#part.corr = T, #Print partial (labeled "partial.r") and semipartial (labeled "part.r")</span></span>
<span id="cb56-1351"><a href="#cb56-1351" aria-hidden="true" tabindex="-1"></a>    <span class="co">#confint = getOption("summ-confint", FALSE),</span></span>
<span id="cb56-1352"><a href="#cb56-1352" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ci.width = getOption("summ-ci.width", 0.95),</span></span>
<span id="cb56-1353"><a href="#cb56-1353" aria-hidden="true" tabindex="-1"></a>    <span class="co">#vifs = T</span></span>
<span id="cb56-1354"><a href="#cb56-1354" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1355"><a href="#cb56-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1356"><a href="#cb56-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1357"><a href="#cb56-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1358"><a href="#cb56-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_45}</span></span>
<span id="cb56-1359"><a href="#cb56-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_int)</span>
<span id="cb56-1360"><a href="#cb56-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1361"><a href="#cb56-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1362"><a href="#cb56-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1363"><a href="#cb56-1363" aria-hidden="true" tabindex="-1"></a>Also calculating the confidence interval for the variances of each model (we should really only care about the intercept variance, maybe MH):</span>
<span id="cb56-1364"><a href="#cb56-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1365"><a href="#cb56-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_46}</span></span>
<span id="cb56-1366"><a href="#cb56-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb56-1367"><a href="#cb56-1367" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">confint</span>(model2),<span class="dv">3</span>)</span>
<span id="cb56-1368"><a href="#cb56-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1369"><a href="#cb56-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1370"><a href="#cb56-1370" aria-hidden="true" tabindex="-1"></a><span class="al">![](/images/CIs.png)</span></span>
<span id="cb56-1371"><a href="#cb56-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1372"><a href="#cb56-1372" aria-hidden="true" tabindex="-1"></a>And the random effects for provinces (for visualization later):</span>
<span id="cb56-1373"><a href="#cb56-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1374"><a href="#cb56-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_47}</span></span>
<span id="cb56-1375"><a href="#cb56-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb56-1376"><a href="#cb56-1376" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model2)</span>
<span id="cb56-1377"><a href="#cb56-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1378"><a href="#cb56-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1379"><a href="#cb56-1379" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marginal Effects </span></span>
<span id="cb56-1380"><a href="#cb56-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1381"><a href="#cb56-1381" aria-hidden="true" tabindex="-1"></a>First, let's see which model is better: </span>
<span id="cb56-1382"><a href="#cb56-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1383"><a href="#cb56-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_48}</span></span>
<span id="cb56-1384"><a href="#cb56-1384" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2, model2_int)</span>
<span id="cb56-1385"><a href="#cb56-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1386"><a href="#cb56-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1387"><a href="#cb56-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1388"><a href="#cb56-1388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_49}</span></span>
<span id="cb56-1389"><a href="#cb56-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(model2, model2_int)</span>
<span id="cb56-1390"><a href="#cb56-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1391"><a href="#cb56-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1392"><a href="#cb56-1392" aria-hidden="true" tabindex="-1"></a>Since <span class="in">`model2`</span> is simpler, and they're not different, I'll go with that. </span>
<span id="cb56-1393"><a href="#cb56-1393" aria-hidden="true" tabindex="-1"></a>Average marginal effects are: </span>
<span id="cb56-1394"><a href="#cb56-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1395"><a href="#cb56-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_50}</span></span>
<span id="cb56-1396"><a href="#cb56-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">margins_summary</span>(model2)</span>
<span id="cb56-1397"><a href="#cb56-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1398"><a href="#cb56-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1399"><a href="#cb56-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1400"><a href="#cb56-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixed Effects of Provinces Visualized</span></span>
<span id="cb56-1401"><a href="#cb56-1401" aria-hidden="true" tabindex="-1"></a>To finish this discussion, I'll visualize the fixed effects of provinces. </span>
<span id="cb56-1402"><a href="#cb56-1402" aria-hidden="true" tabindex="-1"></a>The y-axis shows the intercept shift (effect) for each province.</span>
<span id="cb56-1403"><a href="#cb56-1403" aria-hidden="true" tabindex="-1"></a>A higher value on the y-axis (positive effect) means that after controlling for all variables, people in that province have higher baseline odds of using m-banking.</span>
<span id="cb56-1404"><a href="#cb56-1404" aria-hidden="true" tabindex="-1"></a>A lower value (negative effect) means lower baseline odds.</span>
<span id="cb56-1405"><a href="#cb56-1405" aria-hidden="true" tabindex="-1"></a>Since **Quebec (QC)** and **British Columbia (BC)** have the highest positive effects, we can say mobile banking is more common there, even after accounting for mental health and other variables.</span>
<span id="cb56-1406"><a href="#cb56-1406" aria-hidden="true" tabindex="-1"></a>On the opposite end, **Alberta (AB)** and **Newfoundland &amp; Labrador (NL)** have the lowest random effects, meaning adoption is lower in these provinces.</span>
<span id="cb56-1407"><a href="#cb56-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1408"><a href="#cb56-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1409"><a href="#cb56-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_24}</span></span>
<span id="cb56-1410"><a href="#cb56-1410" aria-hidden="true" tabindex="-1"></a>prov_ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'NL'</span>, <span class="st">'NS'</span>, <span class="st">'NB'</span>, <span class="st">'QC'</span>, <span class="st">'ON'</span>, <span class="st">'MB'</span>, <span class="st">'SK'</span>, <span class="st">'AB'</span>, <span class="st">'BC'</span>)</span>
<span id="cb56-1411"><a href="#cb56-1411" aria-hidden="true" tabindex="-1"></a>prov_n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">24</span>, <span class="dv">35</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">59</span>)</span>
<span id="cb56-1412"><a href="#cb56-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1413"><a href="#cb56-1413" aria-hidden="true" tabindex="-1"></a><span class="co"># random effects are from model 2 </span></span>
<span id="cb56-1414"><a href="#cb56-1414" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.029445800</span>, <span class="fl">0.001523515</span>,<span class="sc">-</span><span class="fl">0.034782017</span>, <span class="fl">0.308732844</span>,<span class="sc">-</span><span class="fl">0.132427568</span>,<span class="sc">-</span><span class="fl">0.129533645</span>,<span class="sc">-</span><span class="fl">0.047807245</span>,<span class="sc">-</span><span class="fl">0.001728474</span>,<span class="fl">0.053000416</span>)</span>
<span id="cb56-1415"><a href="#cb56-1415" aria-hidden="true" tabindex="-1"></a>ranefs_ <span class="ot">&lt;-</span> <span class="fu">round</span>(ranefs_, <span class="dv">4</span>)</span>
<span id="cb56-1416"><a href="#cb56-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1417"><a href="#cb56-1417" aria-hidden="true" tabindex="-1"></a>d_graph <span class="ot">&lt;-</span> <span class="fu">cbind</span>(prov_, prov_n, ranefs_)</span>
<span id="cb56-1418"><a href="#cb56-1418" aria-hidden="true" tabindex="-1"></a>d_graph <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(d_graph)</span>
<span id="cb56-1419"><a href="#cb56-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1420"><a href="#cb56-1420" aria-hidden="true" tabindex="-1"></a>provs_fullnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Newfoundland and Labrador'</span>, <span class="st">'Nova Scotia'</span>, <span class="st">'New Brunswick'</span>,<span class="st">'Quebec'</span>, <span class="st">'Ontario'</span>, <span class="st">'Manitoba'</span>, <span class="st">'Saskatchewan'</span>, <span class="st">'Alberta'</span>, <span class="st">'British Columbia'</span>)</span>
<span id="cb56-1421"><a href="#cb56-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1422"><a href="#cb56-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1423"><a href="#cb56-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1424"><a href="#cb56-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1425"><a href="#cb56-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk_2DA_25}</span></span>
<span id="cb56-1426"><a href="#cb56-1426" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d_graph, <span class="fu">aes</span>(<span class="at">x =</span> prov_n, <span class="at">y =</span> ranefs_, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">'NL'</span>, <span class="st">'NS'</span>, <span class="st">'NB'</span>, <span class="st">'QC'</span>, <span class="st">'ON'</span>, <span class="st">'MB'</span>, <span class="st">'SK'</span>, <span class="st">'AB'</span>, <span class="st">'BC'</span>))) <span class="sc">+</span>   </span>
<span id="cb56-1427"><a href="#cb56-1427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb56-1428"><a href="#cb56-1428" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb56-1429"><a href="#cb56-1429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb56-1430"><a href="#cb56-1430" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Province Code"</span>,</span>
<span id="cb56-1431"><a href="#cb56-1431" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Random Effect"</span>,</span>
<span id="cb56-1432"><a href="#cb56-1432" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"Province"</span></span>
<span id="cb56-1433"><a href="#cb56-1433" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">fill =</span> provs_fullnames), <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb56-1434"><a href="#cb56-1434" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> provs_fullnames, <span class="at">name =</span> <span class="st">"province"</span>)</span>
<span id="cb56-1435"><a href="#cb56-1435" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb56-1436"><a href="#cb56-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>